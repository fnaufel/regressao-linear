<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="pt" xml:lang="pt"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Regressão Linear - 1&nbsp; Regressão linear simples</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./multipla.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Nenhum resultado",
    "search-matching-documents-text": "documentos correspondentes",
    "search-copy-link-title": "Copiar link para a busca",
    "search-hide-matches-text": "Esconder correspondências adicionais",
    "search-more-match-text": "mais correspondência neste documento",
    "search-more-matches-text": "mais correspondências neste documento",
    "search-clear-button-title": "Limpar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Procurar"
  }
}</script><script async="" src="https://hypothes.is/embed.js"></script><script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script><link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./simples.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regressão linear simples</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Regressão Linear</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/fnaufel/regressao-linear" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <a href="./regressao-linear.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=%7Curl%7C">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=%7Curl%7C">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=%7Curl%7C">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
</div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Procurar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Apresentação</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./simples.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regressão linear simples</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multipla.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Regressão linear múltipla</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referências</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Índice</h2>
   
  <ul>
<li>
<a href="#exemplo-vendas-e-publicidade" id="toc-exemplo-vendas-e-publicidade" class="nav-link active" data-scroll-target="#exemplo-vendas-e-publicidade"><span class="header-section-number">1.1</span> Exemplo: vendas e publicidade</a>
  <ul>
<li><a href="#leitura-e-limpeza" id="toc-leitura-e-limpeza" class="nav-link" data-scroll-target="#leitura-e-limpeza">Leitura e limpeza</a></li>
  <li><a href="#divis%C3%A3o-em-dados-de-treino-e-teste" id="toc-divisão-em-dados-de-treino-e-teste" class="nav-link" data-scroll-target="#divis%C3%A3o-em-dados-de-treino-e-teste">Divisão em dados de treino e teste</a></li>
  <li>
<a href="#vendas-por-verba-gasta-em-tv" id="toc-vendas-por-verba-gasta-em-tv" class="nav-link" data-scroll-target="#vendas-por-verba-gasta-em-tv">Vendas por verba gasta em TV</a>
  <ul class="collapse">
<li><a href="#an%C3%A1lise-explorat%C3%B3ria" id="toc-análise-exploratória" class="nav-link" data-scroll-target="#an%C3%A1lise-explorat%C3%B3ria">Análise exploratória</a></li>
  <li><a href="#lm-vendas-tv" id="toc-lm-vendas-tv" class="nav-link" data-scroll-target="#lm-vendas-tv">Modelo linear</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#teoria" id="toc-teoria" class="nav-link" data-scroll-target="#teoria"><span class="header-section-number">1.2</span> Teoria</a>
  <ul>
<li><a href="#estimativas-hatbeta_0-e-hatbeta_1" id="toc-estimativas-hatbeta_0-e-hatbeta_1" class="nav-link" data-scroll-target="#estimativas-hatbeta_0-e-hatbeta_1">Estimativas <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span></a></li>
  <li>
<a href="#erros-padr%C3%A3o-das-estimativas" id="toc-erros-padrão-das-estimativas" class="nav-link" data-scroll-target="#erros-padr%C3%A3o-das-estimativas">Erros-padrão das estimativas</a>
  <ul class="collapse">
<li><a href="#espalhamento-dos-pontos-em-volta-da-reta" id="toc-espalhamento-dos-pontos-em-volta-da-reta" class="nav-link" data-scroll-target="#espalhamento-dos-pontos-em-volta-da-reta">Espalhamento dos pontos em volta da reta</a></li>
  <li><a href="#espalhamento-de-x" id="toc-espalhamento-de-x" class="nav-link" data-scroll-target="#espalhamento-de-x">Espalhamento de <span class="math inline">\(x\)</span></a></li>
  <li><a href="#quantidade-de-dados" id="toc-quantidade-de-dados" class="nav-link" data-scroll-target="#quantidade-de-dados">Quantidade de dados</a></li>
  <li><a href="#juntando-tudo" id="toc-juntando-tudo" class="nav-link" data-scroll-target="#juntando-tudo">Juntando tudo</a></li>
  <li><a href="#erro-padr%C3%A3o-do-intercepto" id="toc-erro-padrão-do-intercepto" class="nav-link" data-scroll-target="#erro-padr%C3%A3o-do-intercepto">Erro-padrão do intercepto</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#vis%C3%A3o-geom%C3%A9trica" id="toc-visão-geométrica" class="nav-link" data-scroll-target="#vis%C3%A3o-geom%C3%A9trica"><span class="header-section-number">1.3</span> Visão geométrica</a>
  <ul>
<li><a href="#um-pequeno-exemplo" id="toc-um-pequeno-exemplo" class="nav-link" data-scroll-target="#um-pequeno-exemplo">Um pequeno exemplo</a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/fnaufel/regressao-linear/edit/master/simples.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">
<span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regressão linear simples</span>
</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Código</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="exemplo-vendas-e-publicidade" class="level2" data-number="1.1"><h2 data-number="1.1" class="anchored" data-anchor-id="exemplo-vendas-e-publicidade">
<span class="header-section-number">1.1</span> Exemplo: vendas e publicidade</h2>
<p>Exemplo baseado no livro <span class="citation" data-cites="james21:_introd_statis_learn">James et al. (<a href="references.html#ref-james21:_introd_statis_learn" role="doc-biblioref">2021</a>)</span>, com dados obtidos de <a href="https://www.kaggle.com/datasets/ashydv/advertising-dataset/data" class="uri">https://www.kaggle.com/datasets/ashydv/advertising-dataset/data</a>.</p>
<p>Este conjunto de dados contém <span class="math inline">\(4\)</span> colunas:</p>
<ul>
<li>
<code>tv</code>: verba (em milhares de dólares) gasta em publicidade na TV;</li>
<li>
<code>radio</code>: verba (em milhares de dólares) gasta em publicidade no rádio;</li>
<li>
<code>jornal</code>: verba (em milhares de dólares) gasta em publicidade em jornais;</li>
<li>
<code>vendas</code>: receita das vendas (em milhares de dólares).</li>
</ul>
<p>Cada observação — isto é, cada linha — corresponde a um produto.</p>
<section id="leitura-e-limpeza" class="level3"><h3 class="anchored" data-anchor-id="leitura-e-limpeza">Leitura e limpeza</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">publicidade</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span></span>
<span>  <span class="st">'dados/advertising.csv'</span>,</span>
<span>  show_col_types <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span></span>
<span>    jornal <span class="op">=</span> <span class="va">newspaper</span>,</span>
<span>    vendas <span class="op">=</span> <span class="va">sales</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">publicidade</span> <span class="op">%&gt;%</span> <span class="fu">gt</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<div id="pzveloiefp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pzveloiefp table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pzveloiefp thead, #pzveloiefp tbody, #pzveloiefp tfoot, #pzveloiefp tr, #pzveloiefp td, #pzveloiefp th {
  border-style: none;
}

#pzveloiefp p {
  margin: 0;
  padding: 0;
}

#pzveloiefp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pzveloiefp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pzveloiefp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pzveloiefp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pzveloiefp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pzveloiefp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pzveloiefp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pzveloiefp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pzveloiefp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pzveloiefp .gt_spanner_row {
  border-bottom-style: hidden;
}

#pzveloiefp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pzveloiefp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pzveloiefp .gt_from_md > :first-child {
  margin-top: 0;
}

#pzveloiefp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pzveloiefp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pzveloiefp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pzveloiefp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pzveloiefp .gt_row_group_first td {
  border-top-width: 2px;
}

#pzveloiefp .gt_row_group_first th {
  border-top-width: 2px;
}

#pzveloiefp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzveloiefp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pzveloiefp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pzveloiefp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzveloiefp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pzveloiefp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pzveloiefp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzveloiefp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pzveloiefp .gt_left {
  text-align: left;
}

#pzveloiefp .gt_center {
  text-align: center;
}

#pzveloiefp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pzveloiefp .gt_font_normal {
  font-weight: normal;
}

#pzveloiefp .gt_font_bold {
  font-weight: bold;
}

#pzveloiefp .gt_font_italic {
  font-style: italic;
}

#pzveloiefp .gt_super {
  font-size: 65%;
}

#pzveloiefp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pzveloiefp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pzveloiefp .gt_indent_1 {
  text-indent: 5px;
}

#pzveloiefp .gt_indent_2 {
  text-indent: 10px;
}

#pzveloiefp .gt_indent_3 {
  text-indent: 15px;
}

#pzveloiefp .gt_indent_4 {
  text-indent: 20px;
}

#pzveloiefp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="tv" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">tv</th>
<th id="radio" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">radio</th>
<th id="jornal" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">jornal</th>
<th id="vendas" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">vendas</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="tv">230,1</td>
<td class="gt_row gt_right" headers="radio">37,8</td>
<td class="gt_row gt_right" headers="jornal">69,2</td>
<td class="gt_row gt_right" headers="vendas">22,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">44,5</td>
<td class="gt_row gt_right" headers="radio">39,3</td>
<td class="gt_row gt_right" headers="jornal">45,1</td>
<td class="gt_row gt_right" headers="vendas">10,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">17,2</td>
<td class="gt_row gt_right" headers="radio">45,9</td>
<td class="gt_row gt_right" headers="jornal">69,3</td>
<td class="gt_row gt_right" headers="vendas">12,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">151,5</td>
<td class="gt_row gt_right" headers="radio">41,3</td>
<td class="gt_row gt_right" headers="jornal">58,5</td>
<td class="gt_row gt_right" headers="vendas">16,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">180,8</td>
<td class="gt_row gt_right" headers="radio">10,8</td>
<td class="gt_row gt_right" headers="jornal">58,4</td>
<td class="gt_row gt_right" headers="vendas">17,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">8,7</td>
<td class="gt_row gt_right" headers="radio">48,9</td>
<td class="gt_row gt_right" headers="jornal">75,0</td>
<td class="gt_row gt_right" headers="vendas">7,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">57,5</td>
<td class="gt_row gt_right" headers="radio">32,8</td>
<td class="gt_row gt_right" headers="jornal">23,5</td>
<td class="gt_row gt_right" headers="vendas">11,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">120,2</td>
<td class="gt_row gt_right" headers="radio">19,6</td>
<td class="gt_row gt_right" headers="jornal">11,6</td>
<td class="gt_row gt_right" headers="vendas">13,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">8,6</td>
<td class="gt_row gt_right" headers="radio">2,1</td>
<td class="gt_row gt_right" headers="jornal">1,0</td>
<td class="gt_row gt_right" headers="vendas">4,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">199,8</td>
<td class="gt_row gt_right" headers="radio">2,6</td>
<td class="gt_row gt_right" headers="jornal">21,2</td>
<td class="gt_row gt_right" headers="vendas">15,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">66,1</td>
<td class="gt_row gt_right" headers="radio">5,8</td>
<td class="gt_row gt_right" headers="jornal">24,2</td>
<td class="gt_row gt_right" headers="vendas">12,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">214,7</td>
<td class="gt_row gt_right" headers="radio">24,0</td>
<td class="gt_row gt_right" headers="jornal">4,0</td>
<td class="gt_row gt_right" headers="vendas">17,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">23,8</td>
<td class="gt_row gt_right" headers="radio">35,1</td>
<td class="gt_row gt_right" headers="jornal">65,9</td>
<td class="gt_row gt_right" headers="vendas">9,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">97,5</td>
<td class="gt_row gt_right" headers="radio">7,6</td>
<td class="gt_row gt_right" headers="jornal">7,2</td>
<td class="gt_row gt_right" headers="vendas">13,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">204,1</td>
<td class="gt_row gt_right" headers="radio">32,9</td>
<td class="gt_row gt_right" headers="jornal">46,0</td>
<td class="gt_row gt_right" headers="vendas">19,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">195,4</td>
<td class="gt_row gt_right" headers="radio">47,7</td>
<td class="gt_row gt_right" headers="jornal">52,9</td>
<td class="gt_row gt_right" headers="vendas">22,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">67,8</td>
<td class="gt_row gt_right" headers="radio">36,6</td>
<td class="gt_row gt_right" headers="jornal">114,0</td>
<td class="gt_row gt_right" headers="vendas">12,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">281,4</td>
<td class="gt_row gt_right" headers="radio">39,6</td>
<td class="gt_row gt_right" headers="jornal">55,8</td>
<td class="gt_row gt_right" headers="vendas">24,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">69,2</td>
<td class="gt_row gt_right" headers="radio">20,5</td>
<td class="gt_row gt_right" headers="jornal">18,3</td>
<td class="gt_row gt_right" headers="vendas">11,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">147,3</td>
<td class="gt_row gt_right" headers="radio">23,9</td>
<td class="gt_row gt_right" headers="jornal">19,1</td>
<td class="gt_row gt_right" headers="vendas">14,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">218,4</td>
<td class="gt_row gt_right" headers="radio">27,7</td>
<td class="gt_row gt_right" headers="jornal">53,4</td>
<td class="gt_row gt_right" headers="vendas">18,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">237,4</td>
<td class="gt_row gt_right" headers="radio">5,1</td>
<td class="gt_row gt_right" headers="jornal">23,5</td>
<td class="gt_row gt_right" headers="vendas">17,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">13,2</td>
<td class="gt_row gt_right" headers="radio">15,9</td>
<td class="gt_row gt_right" headers="jornal">49,6</td>
<td class="gt_row gt_right" headers="vendas">5,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">228,3</td>
<td class="gt_row gt_right" headers="radio">16,9</td>
<td class="gt_row gt_right" headers="jornal">26,2</td>
<td class="gt_row gt_right" headers="vendas">20,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">62,3</td>
<td class="gt_row gt_right" headers="radio">12,6</td>
<td class="gt_row gt_right" headers="jornal">18,3</td>
<td class="gt_row gt_right" headers="vendas">9,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">262,9</td>
<td class="gt_row gt_right" headers="radio">3,5</td>
<td class="gt_row gt_right" headers="jornal">19,5</td>
<td class="gt_row gt_right" headers="vendas">17,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">142,9</td>
<td class="gt_row gt_right" headers="radio">29,3</td>
<td class="gt_row gt_right" headers="jornal">12,6</td>
<td class="gt_row gt_right" headers="vendas">15,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">240,1</td>
<td class="gt_row gt_right" headers="radio">16,7</td>
<td class="gt_row gt_right" headers="jornal">22,9</td>
<td class="gt_row gt_right" headers="vendas">20,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">248,8</td>
<td class="gt_row gt_right" headers="radio">27,1</td>
<td class="gt_row gt_right" headers="jornal">22,9</td>
<td class="gt_row gt_right" headers="vendas">18,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">70,6</td>
<td class="gt_row gt_right" headers="radio">16,0</td>
<td class="gt_row gt_right" headers="jornal">40,8</td>
<td class="gt_row gt_right" headers="vendas">10,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">292,9</td>
<td class="gt_row gt_right" headers="radio">28,3</td>
<td class="gt_row gt_right" headers="jornal">43,2</td>
<td class="gt_row gt_right" headers="vendas">21,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">112,9</td>
<td class="gt_row gt_right" headers="radio">17,4</td>
<td class="gt_row gt_right" headers="jornal">38,6</td>
<td class="gt_row gt_right" headers="vendas">11,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">97,2</td>
<td class="gt_row gt_right" headers="radio">1,5</td>
<td class="gt_row gt_right" headers="jornal">30,0</td>
<td class="gt_row gt_right" headers="vendas">13,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">265,6</td>
<td class="gt_row gt_right" headers="radio">20,0</td>
<td class="gt_row gt_right" headers="jornal">0,3</td>
<td class="gt_row gt_right" headers="vendas">17,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">95,7</td>
<td class="gt_row gt_right" headers="radio">1,4</td>
<td class="gt_row gt_right" headers="jornal">7,4</td>
<td class="gt_row gt_right" headers="vendas">11,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">290,7</td>
<td class="gt_row gt_right" headers="radio">4,1</td>
<td class="gt_row gt_right" headers="jornal">8,5</td>
<td class="gt_row gt_right" headers="vendas">17,8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">266,9</td>
<td class="gt_row gt_right" headers="radio">43,8</td>
<td class="gt_row gt_right" headers="jornal">5,0</td>
<td class="gt_row gt_right" headers="vendas">25,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">74,7</td>
<td class="gt_row gt_right" headers="radio">49,4</td>
<td class="gt_row gt_right" headers="jornal">45,7</td>
<td class="gt_row gt_right" headers="vendas">14,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">43,1</td>
<td class="gt_row gt_right" headers="radio">26,7</td>
<td class="gt_row gt_right" headers="jornal">35,1</td>
<td class="gt_row gt_right" headers="vendas">10,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">228,0</td>
<td class="gt_row gt_right" headers="radio">37,7</td>
<td class="gt_row gt_right" headers="jornal">32,0</td>
<td class="gt_row gt_right" headers="vendas">21,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">202,5</td>
<td class="gt_row gt_right" headers="radio">22,3</td>
<td class="gt_row gt_right" headers="jornal">31,6</td>
<td class="gt_row gt_right" headers="vendas">16,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">177,0</td>
<td class="gt_row gt_right" headers="radio">33,4</td>
<td class="gt_row gt_right" headers="jornal">38,7</td>
<td class="gt_row gt_right" headers="vendas">17,1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">293,6</td>
<td class="gt_row gt_right" headers="radio">27,7</td>
<td class="gt_row gt_right" headers="jornal">1,8</td>
<td class="gt_row gt_right" headers="vendas">20,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">206,9</td>
<td class="gt_row gt_right" headers="radio">8,4</td>
<td class="gt_row gt_right" headers="jornal">26,4</td>
<td class="gt_row gt_right" headers="vendas">17,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">25,1</td>
<td class="gt_row gt_right" headers="radio">25,7</td>
<td class="gt_row gt_right" headers="jornal">43,3</td>
<td class="gt_row gt_right" headers="vendas">8,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">175,1</td>
<td class="gt_row gt_right" headers="radio">22,5</td>
<td class="gt_row gt_right" headers="jornal">31,5</td>
<td class="gt_row gt_right" headers="vendas">16,1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">89,7</td>
<td class="gt_row gt_right" headers="radio">9,9</td>
<td class="gt_row gt_right" headers="jornal">35,7</td>
<td class="gt_row gt_right" headers="vendas">10,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">239,9</td>
<td class="gt_row gt_right" headers="radio">41,5</td>
<td class="gt_row gt_right" headers="jornal">18,5</td>
<td class="gt_row gt_right" headers="vendas">23,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">227,2</td>
<td class="gt_row gt_right" headers="radio">15,8</td>
<td class="gt_row gt_right" headers="jornal">49,9</td>
<td class="gt_row gt_right" headers="vendas">19,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">66,9</td>
<td class="gt_row gt_right" headers="radio">11,7</td>
<td class="gt_row gt_right" headers="jornal">36,8</td>
<td class="gt_row gt_right" headers="vendas">9,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">199,8</td>
<td class="gt_row gt_right" headers="radio">3,1</td>
<td class="gt_row gt_right" headers="jornal">34,6</td>
<td class="gt_row gt_right" headers="vendas">16,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">100,4</td>
<td class="gt_row gt_right" headers="radio">9,6</td>
<td class="gt_row gt_right" headers="jornal">3,6</td>
<td class="gt_row gt_right" headers="vendas">10,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">216,4</td>
<td class="gt_row gt_right" headers="radio">41,7</td>
<td class="gt_row gt_right" headers="jornal">39,6</td>
<td class="gt_row gt_right" headers="vendas">22,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">182,6</td>
<td class="gt_row gt_right" headers="radio">46,2</td>
<td class="gt_row gt_right" headers="jornal">58,7</td>
<td class="gt_row gt_right" headers="vendas">21,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">262,7</td>
<td class="gt_row gt_right" headers="radio">28,8</td>
<td class="gt_row gt_right" headers="jornal">15,9</td>
<td class="gt_row gt_right" headers="vendas">20,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">198,9</td>
<td class="gt_row gt_right" headers="radio">49,4</td>
<td class="gt_row gt_right" headers="jornal">60,0</td>
<td class="gt_row gt_right" headers="vendas">23,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">7,3</td>
<td class="gt_row gt_right" headers="radio">28,1</td>
<td class="gt_row gt_right" headers="jornal">41,4</td>
<td class="gt_row gt_right" headers="vendas">5,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">136,2</td>
<td class="gt_row gt_right" headers="radio">19,2</td>
<td class="gt_row gt_right" headers="jornal">16,6</td>
<td class="gt_row gt_right" headers="vendas">13,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">210,8</td>
<td class="gt_row gt_right" headers="radio">49,6</td>
<td class="gt_row gt_right" headers="jornal">37,7</td>
<td class="gt_row gt_right" headers="vendas">23,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">210,7</td>
<td class="gt_row gt_right" headers="radio">29,5</td>
<td class="gt_row gt_right" headers="jornal">9,3</td>
<td class="gt_row gt_right" headers="vendas">18,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">53,5</td>
<td class="gt_row gt_right" headers="radio">2,0</td>
<td class="gt_row gt_right" headers="jornal">21,4</td>
<td class="gt_row gt_right" headers="vendas">8,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">261,3</td>
<td class="gt_row gt_right" headers="radio">42,7</td>
<td class="gt_row gt_right" headers="jornal">54,7</td>
<td class="gt_row gt_right" headers="vendas">24,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">239,3</td>
<td class="gt_row gt_right" headers="radio">15,5</td>
<td class="gt_row gt_right" headers="jornal">27,3</td>
<td class="gt_row gt_right" headers="vendas">20,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">102,7</td>
<td class="gt_row gt_right" headers="radio">29,6</td>
<td class="gt_row gt_right" headers="jornal">8,4</td>
<td class="gt_row gt_right" headers="vendas">14,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">131,1</td>
<td class="gt_row gt_right" headers="radio">42,8</td>
<td class="gt_row gt_right" headers="jornal">28,9</td>
<td class="gt_row gt_right" headers="vendas">16,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">69,0</td>
<td class="gt_row gt_right" headers="radio">9,3</td>
<td class="gt_row gt_right" headers="jornal">0,9</td>
<td class="gt_row gt_right" headers="vendas">11,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">31,5</td>
<td class="gt_row gt_right" headers="radio">24,6</td>
<td class="gt_row gt_right" headers="jornal">2,2</td>
<td class="gt_row gt_right" headers="vendas">11,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">139,3</td>
<td class="gt_row gt_right" headers="radio">14,5</td>
<td class="gt_row gt_right" headers="jornal">10,2</td>
<td class="gt_row gt_right" headers="vendas">13,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">237,4</td>
<td class="gt_row gt_right" headers="radio">27,5</td>
<td class="gt_row gt_right" headers="jornal">11,0</td>
<td class="gt_row gt_right" headers="vendas">18,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">216,8</td>
<td class="gt_row gt_right" headers="radio">43,9</td>
<td class="gt_row gt_right" headers="jornal">27,2</td>
<td class="gt_row gt_right" headers="vendas">22,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">199,1</td>
<td class="gt_row gt_right" headers="radio">30,6</td>
<td class="gt_row gt_right" headers="jornal">38,7</td>
<td class="gt_row gt_right" headers="vendas">18,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">109,8</td>
<td class="gt_row gt_right" headers="radio">14,3</td>
<td class="gt_row gt_right" headers="jornal">31,7</td>
<td class="gt_row gt_right" headers="vendas">12,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">26,8</td>
<td class="gt_row gt_right" headers="radio">33,0</td>
<td class="gt_row gt_right" headers="jornal">19,3</td>
<td class="gt_row gt_right" headers="vendas">8,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">129,4</td>
<td class="gt_row gt_right" headers="radio">5,7</td>
<td class="gt_row gt_right" headers="jornal">31,3</td>
<td class="gt_row gt_right" headers="vendas">11,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">213,4</td>
<td class="gt_row gt_right" headers="radio">24,6</td>
<td class="gt_row gt_right" headers="jornal">13,1</td>
<td class="gt_row gt_right" headers="vendas">17,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">16,9</td>
<td class="gt_row gt_right" headers="radio">43,7</td>
<td class="gt_row gt_right" headers="jornal">89,4</td>
<td class="gt_row gt_right" headers="vendas">8,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">27,5</td>
<td class="gt_row gt_right" headers="radio">1,6</td>
<td class="gt_row gt_right" headers="jornal">20,7</td>
<td class="gt_row gt_right" headers="vendas">6,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">120,5</td>
<td class="gt_row gt_right" headers="radio">28,5</td>
<td class="gt_row gt_right" headers="jornal">14,2</td>
<td class="gt_row gt_right" headers="vendas">14,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">5,4</td>
<td class="gt_row gt_right" headers="radio">29,9</td>
<td class="gt_row gt_right" headers="jornal">9,4</td>
<td class="gt_row gt_right" headers="vendas">5,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">116,0</td>
<td class="gt_row gt_right" headers="radio">7,7</td>
<td class="gt_row gt_right" headers="jornal">23,1</td>
<td class="gt_row gt_right" headers="vendas">11,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">76,4</td>
<td class="gt_row gt_right" headers="radio">26,7</td>
<td class="gt_row gt_right" headers="jornal">22,3</td>
<td class="gt_row gt_right" headers="vendas">11,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">239,8</td>
<td class="gt_row gt_right" headers="radio">4,1</td>
<td class="gt_row gt_right" headers="jornal">36,9</td>
<td class="gt_row gt_right" headers="vendas">17,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">75,3</td>
<td class="gt_row gt_right" headers="radio">20,3</td>
<td class="gt_row gt_right" headers="jornal">32,5</td>
<td class="gt_row gt_right" headers="vendas">11,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">68,4</td>
<td class="gt_row gt_right" headers="radio">44,5</td>
<td class="gt_row gt_right" headers="jornal">35,6</td>
<td class="gt_row gt_right" headers="vendas">13,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">213,5</td>
<td class="gt_row gt_right" headers="radio">43,0</td>
<td class="gt_row gt_right" headers="jornal">33,8</td>
<td class="gt_row gt_right" headers="vendas">21,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">193,2</td>
<td class="gt_row gt_right" headers="radio">18,4</td>
<td class="gt_row gt_right" headers="jornal">65,7</td>
<td class="gt_row gt_right" headers="vendas">20,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">76,3</td>
<td class="gt_row gt_right" headers="radio">27,5</td>
<td class="gt_row gt_right" headers="jornal">16,0</td>
<td class="gt_row gt_right" headers="vendas">12,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">110,7</td>
<td class="gt_row gt_right" headers="radio">40,6</td>
<td class="gt_row gt_right" headers="jornal">63,2</td>
<td class="gt_row gt_right" headers="vendas">16,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">88,3</td>
<td class="gt_row gt_right" headers="radio">25,5</td>
<td class="gt_row gt_right" headers="jornal">73,4</td>
<td class="gt_row gt_right" headers="vendas">12,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">109,8</td>
<td class="gt_row gt_right" headers="radio">47,8</td>
<td class="gt_row gt_right" headers="jornal">51,4</td>
<td class="gt_row gt_right" headers="vendas">16,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">134,3</td>
<td class="gt_row gt_right" headers="radio">4,9</td>
<td class="gt_row gt_right" headers="jornal">9,3</td>
<td class="gt_row gt_right" headers="vendas">14,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">28,6</td>
<td class="gt_row gt_right" headers="radio">1,5</td>
<td class="gt_row gt_right" headers="jornal">33,0</td>
<td class="gt_row gt_right" headers="vendas">7,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">217,7</td>
<td class="gt_row gt_right" headers="radio">33,5</td>
<td class="gt_row gt_right" headers="jornal">59,0</td>
<td class="gt_row gt_right" headers="vendas">19,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">250,9</td>
<td class="gt_row gt_right" headers="radio">36,5</td>
<td class="gt_row gt_right" headers="jornal">72,3</td>
<td class="gt_row gt_right" headers="vendas">22,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">107,4</td>
<td class="gt_row gt_right" headers="radio">14,0</td>
<td class="gt_row gt_right" headers="jornal">10,9</td>
<td class="gt_row gt_right" headers="vendas">11,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">163,3</td>
<td class="gt_row gt_right" headers="radio">31,6</td>
<td class="gt_row gt_right" headers="jornal">52,9</td>
<td class="gt_row gt_right" headers="vendas">16,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">197,6</td>
<td class="gt_row gt_right" headers="radio">3,5</td>
<td class="gt_row gt_right" headers="jornal">5,9</td>
<td class="gt_row gt_right" headers="vendas">16,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">184,9</td>
<td class="gt_row gt_right" headers="radio">21,0</td>
<td class="gt_row gt_right" headers="jornal">22,0</td>
<td class="gt_row gt_right" headers="vendas">20,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">289,7</td>
<td class="gt_row gt_right" headers="radio">42,3</td>
<td class="gt_row gt_right" headers="jornal">51,2</td>
<td class="gt_row gt_right" headers="vendas">25,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">135,2</td>
<td class="gt_row gt_right" headers="radio">41,7</td>
<td class="gt_row gt_right" headers="jornal">45,9</td>
<td class="gt_row gt_right" headers="vendas">17,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">222,4</td>
<td class="gt_row gt_right" headers="radio">4,3</td>
<td class="gt_row gt_right" headers="jornal">49,8</td>
<td class="gt_row gt_right" headers="vendas">16,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">296,4</td>
<td class="gt_row gt_right" headers="radio">36,3</td>
<td class="gt_row gt_right" headers="jornal">100,9</td>
<td class="gt_row gt_right" headers="vendas">23,8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">280,2</td>
<td class="gt_row gt_right" headers="radio">10,1</td>
<td class="gt_row gt_right" headers="jornal">21,4</td>
<td class="gt_row gt_right" headers="vendas">19,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">187,9</td>
<td class="gt_row gt_right" headers="radio">17,2</td>
<td class="gt_row gt_right" headers="jornal">17,9</td>
<td class="gt_row gt_right" headers="vendas">19,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">238,2</td>
<td class="gt_row gt_right" headers="radio">34,3</td>
<td class="gt_row gt_right" headers="jornal">5,3</td>
<td class="gt_row gt_right" headers="vendas">20,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">137,9</td>
<td class="gt_row gt_right" headers="radio">46,4</td>
<td class="gt_row gt_right" headers="jornal">59,0</td>
<td class="gt_row gt_right" headers="vendas">15,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">25,0</td>
<td class="gt_row gt_right" headers="radio">11,0</td>
<td class="gt_row gt_right" headers="jornal">29,7</td>
<td class="gt_row gt_right" headers="vendas">7,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">90,4</td>
<td class="gt_row gt_right" headers="radio">0,3</td>
<td class="gt_row gt_right" headers="jornal">23,2</td>
<td class="gt_row gt_right" headers="vendas">12,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">13,1</td>
<td class="gt_row gt_right" headers="radio">0,4</td>
<td class="gt_row gt_right" headers="jornal">25,6</td>
<td class="gt_row gt_right" headers="vendas">5,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">255,4</td>
<td class="gt_row gt_right" headers="radio">26,9</td>
<td class="gt_row gt_right" headers="jornal">5,5</td>
<td class="gt_row gt_right" headers="vendas">19,8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">225,8</td>
<td class="gt_row gt_right" headers="radio">8,2</td>
<td class="gt_row gt_right" headers="jornal">56,5</td>
<td class="gt_row gt_right" headers="vendas">18,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">241,7</td>
<td class="gt_row gt_right" headers="radio">38,0</td>
<td class="gt_row gt_right" headers="jornal">23,2</td>
<td class="gt_row gt_right" headers="vendas">21,8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">175,7</td>
<td class="gt_row gt_right" headers="radio">15,4</td>
<td class="gt_row gt_right" headers="jornal">2,4</td>
<td class="gt_row gt_right" headers="vendas">17,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">209,6</td>
<td class="gt_row gt_right" headers="radio">20,6</td>
<td class="gt_row gt_right" headers="jornal">10,7</td>
<td class="gt_row gt_right" headers="vendas">20,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">78,2</td>
<td class="gt_row gt_right" headers="radio">46,8</td>
<td class="gt_row gt_right" headers="jornal">34,5</td>
<td class="gt_row gt_right" headers="vendas">14,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">75,1</td>
<td class="gt_row gt_right" headers="radio">35,0</td>
<td class="gt_row gt_right" headers="jornal">52,7</td>
<td class="gt_row gt_right" headers="vendas">12,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">139,2</td>
<td class="gt_row gt_right" headers="radio">14,3</td>
<td class="gt_row gt_right" headers="jornal">25,6</td>
<td class="gt_row gt_right" headers="vendas">12,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">76,4</td>
<td class="gt_row gt_right" headers="radio">0,8</td>
<td class="gt_row gt_right" headers="jornal">14,8</td>
<td class="gt_row gt_right" headers="vendas">9,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">125,7</td>
<td class="gt_row gt_right" headers="radio">36,9</td>
<td class="gt_row gt_right" headers="jornal">79,2</td>
<td class="gt_row gt_right" headers="vendas">15,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">19,4</td>
<td class="gt_row gt_right" headers="radio">16,0</td>
<td class="gt_row gt_right" headers="jornal">22,3</td>
<td class="gt_row gt_right" headers="vendas">6,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">141,3</td>
<td class="gt_row gt_right" headers="radio">26,8</td>
<td class="gt_row gt_right" headers="jornal">46,2</td>
<td class="gt_row gt_right" headers="vendas">15,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">18,8</td>
<td class="gt_row gt_right" headers="radio">21,7</td>
<td class="gt_row gt_right" headers="jornal">50,4</td>
<td class="gt_row gt_right" headers="vendas">7,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">224,0</td>
<td class="gt_row gt_right" headers="radio">2,4</td>
<td class="gt_row gt_right" headers="jornal">15,6</td>
<td class="gt_row gt_right" headers="vendas">16,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">123,1</td>
<td class="gt_row gt_right" headers="radio">34,6</td>
<td class="gt_row gt_right" headers="jornal">12,4</td>
<td class="gt_row gt_right" headers="vendas">15,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">229,5</td>
<td class="gt_row gt_right" headers="radio">32,3</td>
<td class="gt_row gt_right" headers="jornal">74,2</td>
<td class="gt_row gt_right" headers="vendas">19,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">87,2</td>
<td class="gt_row gt_right" headers="radio">11,8</td>
<td class="gt_row gt_right" headers="jornal">25,9</td>
<td class="gt_row gt_right" headers="vendas">10,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">7,8</td>
<td class="gt_row gt_right" headers="radio">38,9</td>
<td class="gt_row gt_right" headers="jornal">50,6</td>
<td class="gt_row gt_right" headers="vendas">6,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">80,2</td>
<td class="gt_row gt_right" headers="radio">0,0</td>
<td class="gt_row gt_right" headers="jornal">9,2</td>
<td class="gt_row gt_right" headers="vendas">11,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">220,3</td>
<td class="gt_row gt_right" headers="radio">49,0</td>
<td class="gt_row gt_right" headers="jornal">3,2</td>
<td class="gt_row gt_right" headers="vendas">24,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">59,6</td>
<td class="gt_row gt_right" headers="radio">12,0</td>
<td class="gt_row gt_right" headers="jornal">43,1</td>
<td class="gt_row gt_right" headers="vendas">9,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">0,7</td>
<td class="gt_row gt_right" headers="radio">39,6</td>
<td class="gt_row gt_right" headers="jornal">8,7</td>
<td class="gt_row gt_right" headers="vendas">1,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">265,2</td>
<td class="gt_row gt_right" headers="radio">2,9</td>
<td class="gt_row gt_right" headers="jornal">43,0</td>
<td class="gt_row gt_right" headers="vendas">17,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">8,4</td>
<td class="gt_row gt_right" headers="radio">27,2</td>
<td class="gt_row gt_right" headers="jornal">2,1</td>
<td class="gt_row gt_right" headers="vendas">5,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">219,8</td>
<td class="gt_row gt_right" headers="radio">33,5</td>
<td class="gt_row gt_right" headers="jornal">45,1</td>
<td class="gt_row gt_right" headers="vendas">19,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">36,9</td>
<td class="gt_row gt_right" headers="radio">38,6</td>
<td class="gt_row gt_right" headers="jornal">65,6</td>
<td class="gt_row gt_right" headers="vendas">10,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">48,3</td>
<td class="gt_row gt_right" headers="radio">47,0</td>
<td class="gt_row gt_right" headers="jornal">8,5</td>
<td class="gt_row gt_right" headers="vendas">11,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">25,6</td>
<td class="gt_row gt_right" headers="radio">39,0</td>
<td class="gt_row gt_right" headers="jornal">9,3</td>
<td class="gt_row gt_right" headers="vendas">9,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">273,7</td>
<td class="gt_row gt_right" headers="radio">28,9</td>
<td class="gt_row gt_right" headers="jornal">59,7</td>
<td class="gt_row gt_right" headers="vendas">20,8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">43,0</td>
<td class="gt_row gt_right" headers="radio">25,9</td>
<td class="gt_row gt_right" headers="jornal">20,5</td>
<td class="gt_row gt_right" headers="vendas">9,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">184,9</td>
<td class="gt_row gt_right" headers="radio">43,9</td>
<td class="gt_row gt_right" headers="jornal">1,7</td>
<td class="gt_row gt_right" headers="vendas">20,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">73,4</td>
<td class="gt_row gt_right" headers="radio">17,0</td>
<td class="gt_row gt_right" headers="jornal">12,9</td>
<td class="gt_row gt_right" headers="vendas">10,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">193,7</td>
<td class="gt_row gt_right" headers="radio">35,4</td>
<td class="gt_row gt_right" headers="jornal">75,6</td>
<td class="gt_row gt_right" headers="vendas">19,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">220,5</td>
<td class="gt_row gt_right" headers="radio">33,2</td>
<td class="gt_row gt_right" headers="jornal">37,9</td>
<td class="gt_row gt_right" headers="vendas">20,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">104,6</td>
<td class="gt_row gt_right" headers="radio">5,7</td>
<td class="gt_row gt_right" headers="jornal">34,4</td>
<td class="gt_row gt_right" headers="vendas">10,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">96,2</td>
<td class="gt_row gt_right" headers="radio">14,8</td>
<td class="gt_row gt_right" headers="jornal">38,9</td>
<td class="gt_row gt_right" headers="vendas">12,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">140,3</td>
<td class="gt_row gt_right" headers="radio">1,9</td>
<td class="gt_row gt_right" headers="jornal">9,0</td>
<td class="gt_row gt_right" headers="vendas">10,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">240,1</td>
<td class="gt_row gt_right" headers="radio">7,3</td>
<td class="gt_row gt_right" headers="jornal">8,7</td>
<td class="gt_row gt_right" headers="vendas">18,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">243,2</td>
<td class="gt_row gt_right" headers="radio">49,0</td>
<td class="gt_row gt_right" headers="jornal">44,3</td>
<td class="gt_row gt_right" headers="vendas">25,4</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">38,0</td>
<td class="gt_row gt_right" headers="radio">40,3</td>
<td class="gt_row gt_right" headers="jornal">11,9</td>
<td class="gt_row gt_right" headers="vendas">10,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">44,7</td>
<td class="gt_row gt_right" headers="radio">25,8</td>
<td class="gt_row gt_right" headers="jornal">20,6</td>
<td class="gt_row gt_right" headers="vendas">10,1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">280,7</td>
<td class="gt_row gt_right" headers="radio">13,9</td>
<td class="gt_row gt_right" headers="jornal">37,0</td>
<td class="gt_row gt_right" headers="vendas">16,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">121,0</td>
<td class="gt_row gt_right" headers="radio">8,4</td>
<td class="gt_row gt_right" headers="jornal">48,7</td>
<td class="gt_row gt_right" headers="vendas">11,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">197,6</td>
<td class="gt_row gt_right" headers="radio">23,3</td>
<td class="gt_row gt_right" headers="jornal">14,2</td>
<td class="gt_row gt_right" headers="vendas">16,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">171,3</td>
<td class="gt_row gt_right" headers="radio">39,7</td>
<td class="gt_row gt_right" headers="jornal">37,7</td>
<td class="gt_row gt_right" headers="vendas">16,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">187,8</td>
<td class="gt_row gt_right" headers="radio">21,1</td>
<td class="gt_row gt_right" headers="jornal">9,5</td>
<td class="gt_row gt_right" headers="vendas">20,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">4,1</td>
<td class="gt_row gt_right" headers="radio">11,6</td>
<td class="gt_row gt_right" headers="jornal">5,7</td>
<td class="gt_row gt_right" headers="vendas">3,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">93,9</td>
<td class="gt_row gt_right" headers="radio">43,5</td>
<td class="gt_row gt_right" headers="jornal">50,5</td>
<td class="gt_row gt_right" headers="vendas">15,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">149,8</td>
<td class="gt_row gt_right" headers="radio">1,3</td>
<td class="gt_row gt_right" headers="jornal">24,3</td>
<td class="gt_row gt_right" headers="vendas">10,1</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">11,7</td>
<td class="gt_row gt_right" headers="radio">36,9</td>
<td class="gt_row gt_right" headers="jornal">45,2</td>
<td class="gt_row gt_right" headers="vendas">7,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">131,7</td>
<td class="gt_row gt_right" headers="radio">18,4</td>
<td class="gt_row gt_right" headers="jornal">34,6</td>
<td class="gt_row gt_right" headers="vendas">12,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">172,5</td>
<td class="gt_row gt_right" headers="radio">18,1</td>
<td class="gt_row gt_right" headers="jornal">30,7</td>
<td class="gt_row gt_right" headers="vendas">16,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">85,7</td>
<td class="gt_row gt_right" headers="radio">35,8</td>
<td class="gt_row gt_right" headers="jornal">49,3</td>
<td class="gt_row gt_right" headers="vendas">13,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">188,4</td>
<td class="gt_row gt_right" headers="radio">18,1</td>
<td class="gt_row gt_right" headers="jornal">25,6</td>
<td class="gt_row gt_right" headers="vendas">19,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">163,5</td>
<td class="gt_row gt_right" headers="radio">36,8</td>
<td class="gt_row gt_right" headers="jornal">7,4</td>
<td class="gt_row gt_right" headers="vendas">18,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">117,2</td>
<td class="gt_row gt_right" headers="radio">14,7</td>
<td class="gt_row gt_right" headers="jornal">5,4</td>
<td class="gt_row gt_right" headers="vendas">11,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">234,5</td>
<td class="gt_row gt_right" headers="radio">3,4</td>
<td class="gt_row gt_right" headers="jornal">84,8</td>
<td class="gt_row gt_right" headers="vendas">16,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">17,9</td>
<td class="gt_row gt_right" headers="radio">37,6</td>
<td class="gt_row gt_right" headers="jornal">21,6</td>
<td class="gt_row gt_right" headers="vendas">8,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">206,8</td>
<td class="gt_row gt_right" headers="radio">5,2</td>
<td class="gt_row gt_right" headers="jornal">19,4</td>
<td class="gt_row gt_right" headers="vendas">17,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">215,4</td>
<td class="gt_row gt_right" headers="radio">23,6</td>
<td class="gt_row gt_right" headers="jornal">57,6</td>
<td class="gt_row gt_right" headers="vendas">17,1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">284,3</td>
<td class="gt_row gt_right" headers="radio">10,6</td>
<td class="gt_row gt_right" headers="jornal">6,4</td>
<td class="gt_row gt_right" headers="vendas">20,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">50,0</td>
<td class="gt_row gt_right" headers="radio">11,6</td>
<td class="gt_row gt_right" headers="jornal">18,4</td>
<td class="gt_row gt_right" headers="vendas">8,4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">164,5</td>
<td class="gt_row gt_right" headers="radio">20,9</td>
<td class="gt_row gt_right" headers="jornal">47,4</td>
<td class="gt_row gt_right" headers="vendas">17,5</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">19,6</td>
<td class="gt_row gt_right" headers="radio">20,1</td>
<td class="gt_row gt_right" headers="jornal">17,0</td>
<td class="gt_row gt_right" headers="vendas">7,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">168,4</td>
<td class="gt_row gt_right" headers="radio">7,1</td>
<td class="gt_row gt_right" headers="jornal">12,8</td>
<td class="gt_row gt_right" headers="vendas">16,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">222,4</td>
<td class="gt_row gt_right" headers="radio">3,4</td>
<td class="gt_row gt_right" headers="jornal">13,1</td>
<td class="gt_row gt_right" headers="vendas">16,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">276,9</td>
<td class="gt_row gt_right" headers="radio">48,9</td>
<td class="gt_row gt_right" headers="jornal">41,8</td>
<td class="gt_row gt_right" headers="vendas">27,0</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">248,4</td>
<td class="gt_row gt_right" headers="radio">30,2</td>
<td class="gt_row gt_right" headers="jornal">20,3</td>
<td class="gt_row gt_right" headers="vendas">20,2</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">170,2</td>
<td class="gt_row gt_right" headers="radio">7,8</td>
<td class="gt_row gt_right" headers="jornal">35,2</td>
<td class="gt_row gt_right" headers="vendas">16,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">276,7</td>
<td class="gt_row gt_right" headers="radio">2,3</td>
<td class="gt_row gt_right" headers="jornal">23,7</td>
<td class="gt_row gt_right" headers="vendas">16,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">165,6</td>
<td class="gt_row gt_right" headers="radio">10,0</td>
<td class="gt_row gt_right" headers="jornal">17,6</td>
<td class="gt_row gt_right" headers="vendas">17,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">156,6</td>
<td class="gt_row gt_right" headers="radio">2,6</td>
<td class="gt_row gt_right" headers="jornal">8,3</td>
<td class="gt_row gt_right" headers="vendas">15,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">218,5</td>
<td class="gt_row gt_right" headers="radio">5,4</td>
<td class="gt_row gt_right" headers="jornal">27,4</td>
<td class="gt_row gt_right" headers="vendas">17,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">56,2</td>
<td class="gt_row gt_right" headers="radio">5,7</td>
<td class="gt_row gt_right" headers="jornal">29,7</td>
<td class="gt_row gt_right" headers="vendas">8,7</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">287,6</td>
<td class="gt_row gt_right" headers="radio">43,0</td>
<td class="gt_row gt_right" headers="jornal">71,8</td>
<td class="gt_row gt_right" headers="vendas">26,2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">253,8</td>
<td class="gt_row gt_right" headers="radio">21,3</td>
<td class="gt_row gt_right" headers="jornal">30,0</td>
<td class="gt_row gt_right" headers="vendas">17,6</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">205,0</td>
<td class="gt_row gt_right" headers="radio">45,1</td>
<td class="gt_row gt_right" headers="jornal">19,6</td>
<td class="gt_row gt_right" headers="vendas">22,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">139,5</td>
<td class="gt_row gt_right" headers="radio">2,1</td>
<td class="gt_row gt_right" headers="jornal">26,6</td>
<td class="gt_row gt_right" headers="vendas">10,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">191,1</td>
<td class="gt_row gt_right" headers="radio">28,7</td>
<td class="gt_row gt_right" headers="jornal">18,2</td>
<td class="gt_row gt_right" headers="vendas">17,3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">286,0</td>
<td class="gt_row gt_right" headers="radio">13,9</td>
<td class="gt_row gt_right" headers="jornal">3,7</td>
<td class="gt_row gt_right" headers="vendas">20,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">18,7</td>
<td class="gt_row gt_right" headers="radio">12,1</td>
<td class="gt_row gt_right" headers="jornal">23,4</td>
<td class="gt_row gt_right" headers="vendas">6,7</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">39,5</td>
<td class="gt_row gt_right" headers="radio">41,1</td>
<td class="gt_row gt_right" headers="jornal">5,8</td>
<td class="gt_row gt_right" headers="vendas">10,8</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">75,5</td>
<td class="gt_row gt_right" headers="radio">10,8</td>
<td class="gt_row gt_right" headers="jornal">6,0</td>
<td class="gt_row gt_right" headers="vendas">11,9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">17,2</td>
<td class="gt_row gt_right" headers="radio">4,1</td>
<td class="gt_row gt_right" headers="jornal">31,6</td>
<td class="gt_row gt_right" headers="vendas">5,9</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">166,8</td>
<td class="gt_row gt_right" headers="radio">42,0</td>
<td class="gt_row gt_right" headers="jornal">3,6</td>
<td class="gt_row gt_right" headers="vendas">19,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">149,7</td>
<td class="gt_row gt_right" headers="radio">35,6</td>
<td class="gt_row gt_right" headers="jornal">6,0</td>
<td class="gt_row gt_right" headers="vendas">17,3</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">38,2</td>
<td class="gt_row gt_right" headers="radio">3,7</td>
<td class="gt_row gt_right" headers="jornal">13,8</td>
<td class="gt_row gt_right" headers="vendas">7,6</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">94,2</td>
<td class="gt_row gt_right" headers="radio">4,9</td>
<td class="gt_row gt_right" headers="jornal">8,1</td>
<td class="gt_row gt_right" headers="vendas">14,0</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">177,0</td>
<td class="gt_row gt_right" headers="radio">9,3</td>
<td class="gt_row gt_right" headers="jornal">6,4</td>
<td class="gt_row gt_right" headers="vendas">14,8</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="tv">283,6</td>
<td class="gt_row gt_right" headers="radio">42,0</td>
<td class="gt_row gt_right" headers="jornal">66,2</td>
<td class="gt_row gt_right" headers="vendas">25,5</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="tv">232,1</td>
<td class="gt_row gt_right" headers="radio">8,6</td>
<td class="gt_row gt_right" headers="jornal">8,7</td>
<td class="gt_row gt_right" headers="vendas">18,4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</section><section id="divisão-em-dados-de-treino-e-teste" class="level3"><h3 class="anchored" data-anchor-id="divisão-em-dados-de-treino-e-teste">Divisão em dados de treino e teste</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="va">publicidade</span><span class="op">)</span></span>
<span><span class="va">treino</span> <span class="op">&lt;-</span> <span class="fu">training</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span><span class="va">teste</span> <span class="op">&lt;-</span> <span class="fu">testing</span><span class="op">(</span><span class="va">split</span><span class="op">)</span></span>
<span><span class="va">split</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Training/Testing/Total&gt;
&lt;150/50/200&gt;</code></pre>
</div>
</div>
</section><section id="vendas-por-verba-gasta-em-tv" class="level3"><h3 class="anchored" data-anchor-id="vendas-por-verba-gasta-em-tv">Vendas por verba gasta em TV</h3>
<section id="análise-exploratória" class="level4"><h4 class="anchored" data-anchor-id="análise-exploratória">Análise exploratória</h4>
<p>Começamos visualizando os dados:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grafico</span> <span class="op">&lt;-</span> <span class="va">treino</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">tv</span>, <span class="va">vendas</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">grafico</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="simples_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A correlação linear entre vendas e tv é</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">treino</span><span class="op">$</span><span class="va">vendas</span>, <span class="va">treino</span><span class="op">$</span><span class="va">tv</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0,8926062</code></pre>
</div>
</div>
</section><section id="lm-vendas-tv" class="level4"><h4 class="anchored" data-anchor-id="lm-vendas-tv">Modelo linear</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">vendas</span> <span class="op">~</span> <span class="va">tv</span>, data <span class="op">=</span> <span class="va">treino</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = vendas ~ tv, data = treino)

Residuals:
    Min      1Q  Median      3Q     Max 
-6,3046 -1,7075 -0,0832  1,7818  5,7983 

Coefficients:
            Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept) 6,952703   0,386109   18,01 &lt;0,0000000000000002 ***
tv          0,055048   0,002285   24,09 &lt;0,0000000000000002 ***
---
Signif. codes:  0 '***' 0,001 '**' 0,01 '*' 0,05 '.' 0,1 ' ' 1

Residual standard error: 2,402 on 148 degrees of freedom
Multiple R-squared:  0,7967,    Adjusted R-squared:  0,7954 
F-statistic: 580,2 on 1 and 148 DF,  p-value: &lt; 0,00000000000000022</code></pre>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo_tidy</span> <span class="op">&lt;-</span> <span class="fu">tidy</span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span>
<span><span class="va">modelo_tidy</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"6,95270294","3":"0,386108602","4":"18,00712","5":"4,042245e-39"},{"1":"tv","2":"0,05504781","3":"0,002285436","4":"24,08635","5":"4,566743e-53"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">b0</span> <span class="op">&lt;-</span> <span class="va">modelo_tidy</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">b1</span> <span class="op">&lt;-</span> <span class="va">modelo_tidy</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">grafico</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_abline</span><span class="op">(</span></span>
<span>    intercept <span class="op">=</span> <span class="va">b0</span>,</span>
<span>    slope <span class="op">=</span> <span class="va">b1</span>,</span>
<span>    color <span class="op">=</span> <span class="st">'blue'</span></span>
<span>  <span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="simples_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>A equação da reta é</p>
<p><span class="math display">\[
\begin{aligned}
  \widehat{\text{vendas}}
  &amp;= \hat{\beta_0} + \hat{\beta_1} \cdot \text{tv} \\
  &amp;= 6{,}95 + 0{,}06 \cdot \text{tv}
\end{aligned}
\]</span></p>
</section></section></section><section id="teoria" class="level2" data-number="1.2"><h2 data-number="1.2" class="anchored" data-anchor-id="teoria">
<span class="header-section-number">1.2</span> Teoria</h2>
<section id="estimativas-hatbeta_0-e-hatbeta_1" class="level3"><h3 class="anchored" data-anchor-id="estimativas-hatbeta_0-e-hatbeta_1">Estimativas <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>
</h3>
<p>Os valores achados são estimativas para <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>, baseadas nos dados do conjunto de treino.</p>
<p>Por isso, os valores de <code>vendas</code> obtidos com esta equação também são estimativas.</p>
<p>Vamos escrever estimativas com o acento circunflexo (chapéu) sobre os símbolos.</p>
<p>De onde vêm os valores de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>?</p>
<p>Resposta: são os valores que fazem com que a soma dos quadrados das distâncias verticais dos pontos à reta seja a menor possível.</p>
<p>(Estas distâncias são chamadas de <span class="hl">resíduos</span>.)</p>
<p><a href="https://fnaufel.github.io/probestr/regr.html#como-achar-a-equa%C3%A7%C3%A3o-da-melhor-reta-com-c%C3%A1lculo">Consulte este material</a> para ver os detalhes sobre o cálculo de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>.</p>
</section><section id="erros-padrão-das-estimativas" class="level3"><h3 class="anchored" data-anchor-id="erros-padrão-das-estimativas">Erros-padrão das estimativas</h3>
<p>Vamos pensar nas incertezas associadas aos valores de <span class="math inline">\(\hat{\beta_0}\)</span> e <span class="math inline">\(\hat{\beta_1}\)</span>, com base na excelente discussão em <span class="citation" data-cites="de15:_stats">(<a href="references.html#ref-de15:_stats" role="doc-biblioref">De Veaux, Velleman e Bock 2016, cap. 25</a>)</span>.</p>
<p>Quais são os fatores que afetam a nossa confiança na reta de regressão?</p>
<p>Mais especificamente, <span class="hl">quais os fatores que afetam nossa confiança no valor estimado <span class="math inline">\(\hat\beta_1\)</span></span> (a inclinação da reta)?</p>
<section id="espalhamento-dos-pontos-em-volta-da-reta" class="level4"><h4 class="anchored" data-anchor-id="espalhamento-dos-pontos-em-volta-da-reta">Espalhamento dos pontos em volta da reta</h4>
<p>Quanto mais afastados da reta estiverem os dados, menor a nossa confiança de que a reta captura a variação de uma variável em função da outra.</p>
<p>Observe a <a href="#fig-spread" class="quarto-xref">Figura&nbsp;<span>1.1</span></a>. O gráfico da esquerda nos dá mais certeza de que uma reta de regressão terá uma inclinação bem próxima da taxa de variação de <span class="math inline">\(y\)</span> em função de <span class="math inline">\(x\)</span> na população.</p>
<div id="fig-spread" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Dois gráficos de dispersão" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-spread-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/spread.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Dois gráficos de dispersão">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spread-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1.1: Espalhamento dos pontos
</figcaption></figure>
</div>
<p>Este espalhamento é medido pelo <span class="hl">desvio-padrão dos resíduos</span>.</p>
<p><a href="#lm-vendas-tv">No exemplo das vendas</a>, este desvio-padrão dos resíduos é calculado como</p>
<p><span class="math display">\[
\displaystyle
\sqrt{
\frac{\sum_i (\text{vendas}_i - \widehat{\text{vendas}}_i)^2}{n-2}
}
\]</span></p>
<p>No numerador, o valor <span class="math inline">\(\text{vendas}_i - \widehat{\text{vendas}}_i\)</span> é o resíduo da observação <span class="math inline">\(i\)</span>.</p>
<p>As <code>vendas</code> estimadas para cada valor de <code>tv</code> e os valores dos resíduos podem ser acessados assim:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo_augment</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span>
<span><span class="va">modelo_augment</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">vendas</span>, <span class="va">tv</span>, <span class="va">.fitted</span>, <span class="va">.resid</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["vendas"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["tv"],"name":[2],"type":["dbl"],"align":["right"]},{"label":[".fitted"],"name":[3],"type":["dbl"],"align":["right"]},{"label":[".resid"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"17,7","2":"265,2","3":"21,551382","4":"-3,85138158"},{"1":"20,5","2":"184,9","3":"17,131043","4":"3,36895739"},{"1":"19,8","2":"280,2","3":"22,377099","4":"-2,57709869"},{"1":"16,7","2":"109,8","3":"12,996952","4":"3,70304776"},{"1":"22,3","2":"216,8","3":"18,887068","4":"3,41293232"},{"1":"5,3","2":"5,4","3":"7,249961","4":"-1,94996111"},{"1":"12,6","2":"75,1","3":"11,086793","4":"1,51320669"},{"1":"13,7","2":"97,5","3":"12,319864","4":"1,38013579"},{"1":"10,6","2":"87,2","3":"11,752872","4":"-1,15287178"},{"1":"26,2","2":"287,6","3":"22,784452","4":"3,41554753"},{"1":"24,2","2":"261,3","3":"21,336695","4":"2,86330488"},{"1":"16,5","2":"151,5","3":"15,292446","4":"1,20755417"},{"1":"18,4","2":"232,1","3":"19,729299","4":"-1,32929914"},{"1":"10,9","2":"38,0","3":"9,044520","4":"1,85548036"},{"1":"21,5","2":"228,0","3":"19,503603","4":"1,99639688"},{"1":"10,8","2":"39,5","3":"9,127091","4":"1,67290865"},{"1":"19,4","2":"217,7","3":"18,936611","4":"0,46338930"},{"1":"7,0","2":"18,8","3":"7,987602","4":"-0,98760173"},{"1":"5,7","2":"8,4","3":"7,415105","4":"-1,71510453"},{"1":"11,3","2":"69,0","3":"10,751002","4":"0,54899832"},{"1":"16,5","2":"222,4","3":"19,195335","4":"-2,69533540"},{"1":"17,2","2":"206,8","3":"18,336590","4":"-1,13658960"},{"1":"16,6","2":"224,0","3":"19,283412","4":"-2,68341189"},{"1":"23,2","2":"239,9","3":"20,158672","4":"3,04132796"},{"1":"12,0","2":"90,4","3":"11,929025","4":"0,07097523"},{"1":"1,6","2":"0,7","3":"6,991236","4":"-5,39123641"},{"1":"12,0","2":"76,3","3":"11,152851","4":"0,84714932"},{"1":"16,6","2":"202,5","3":"18,099884","4":"-1,49988403"},{"1":"14,6","2":"78,2","3":"11,257442","4":"3,34255849"},{"1":"12,4","2":"109,8","3":"12,996952","4":"-0,59695224"},{"1":"12,9","2":"131,7","3":"14,202499","4":"-1,30249923"},{"1":"17,1","2":"177,0","3":"16,696165","4":"0,40383507"},{"1":"20,7","2":"293,6","3":"23,114739","4":"-2,41473932"},{"1":"10,4","2":"44,5","3":"9,402330","4":"0,99766961"},{"1":"12,2","2":"139,2","3":"14,615358","4":"-2,41535779"},{"1":"17,3","2":"149,7","3":"15,193360","4":"2,10664023"},{"1":"19,8","2":"227,2","3":"19,459565","4":"0,34043512"},{"1":"23,8","2":"296,4","3":"23,268873","4":"0,53112682"},{"1":"16,4","2":"199,8","3":"17,951255","4":"-1,55125494"},{"1":"19,6","2":"219,8","3":"19,052211","4":"0,54778890"},{"1":"18,0","2":"163,5","3":"15,953020","4":"2,04698048"},{"1":"20,0","2":"284,3","3":"22,602795","4":"-2,60279470"},{"1":"5,5","2":"7,3","3":"7,354552","4":"-1,85455194"},{"1":"11,6","2":"48,3","3":"9,611512","4":"1,98848794"},{"1":"17,0","2":"262,9","3":"21,424772","4":"-4,42477162"},{"1":"12,3","2":"96,2","3":"12,248302","4":"0,05169795"},{"1":"16,7","2":"170,2","3":"16,321840","4":"0,37816017"},{"1":"13,2","2":"120,2","3":"13,569449","4":"-0,36944944"},{"1":"16,9","2":"163,3","3":"15,942010","4":"0,95799004"},{"1":"17,5","2":"237,4","3":"20,021053","4":"-2,52105252"},{"1":"11,9","2":"95,7","3":"12,220778","4":"-0,32077815"},{"1":"7,6","2":"19,6","3":"8,031640","4":"-0,43163998"},{"1":"17,6","2":"165,6","3":"16,068620","4":"1,53138008"},{"1":"20,2","2":"193,2","3":"17,587939","4":"2,61206059"},{"1":"10,1","2":"149,8","3":"15,198865","4":"-5,09886455"},{"1":"15,6","2":"199,8","3":"17,951255","4":"-2,35125494"},{"1":"5,3","2":"13,1","3":"7,673829","4":"-2,37382923"},{"1":"25,4","2":"243,2","3":"20,340330","4":"5,05967020"},{"1":"11,3","2":"75,3","3":"11,097803","4":"0,20219713"},{"1":"7,6","2":"38,2","3":"9,055529","4":"-1,45552920"},{"1":"14,6","2":"147,3","3":"15,061245","4":"-0,46124503"},{"1":"18,3","2":"199,1","3":"17,912721","4":"0,38727852"},{"1":"8,1","2":"53,5","3":"9,897761","4":"-1,79776066"},{"1":"11,6","2":"121,0","3":"13,613488","4":"-2,01348769"},{"1":"10,9","2":"73,4","3":"10,993212","4":"-0,09321204"},{"1":"6,6","2":"7,8","3":"7,382076","4":"-0,78207584"},{"1":"8,4","2":"50,0","3":"9,705093","4":"-1,30509333"},{"1":"20,2","2":"248,4","3":"20,626578","4":"-0,42657840"},{"1":"18,4","2":"210,7","3":"18,551276","4":"-0,15127605"},{"1":"17,8","2":"290,7","3":"22,955101","4":"-5,15510067"},{"1":"15,9","2":"125,7","3":"13,872212","4":"2,02778761"},{"1":"11,3","2":"69,2","3":"10,762011","4":"0,53798876"},{"1":"4,8","2":"8,6","3":"7,426114","4":"-2,62611409"},{"1":"11,9","2":"75,5","3":"11,108812","4":"0,79118757"},{"1":"10,5","2":"70,6","3":"10,839078","4":"-0,33907817"},{"1":"20,7","2":"239,3","3":"20,125643","4":"0,57435665"},{"1":"19,6","2":"166,8","3":"16,134677","4":"3,46532271"},{"1":"12,5","2":"67,8","3":"10,684944","4":"1,81505569"},{"1":"19,9","2":"188,4","3":"17,323710","4":"2,57629006"},{"1":"18,2","2":"240,1","3":"20,169682","4":"-1,96968160"},{"1":"13,2","2":"136,2","3":"14,450214","4":"-1,25021437"},{"1":"7,2","2":"8,7","3":"7,431619","4":"-0,23161887"},{"1":"21,7","2":"213,5","3":"18,705410","4":"2,99459009"},{"1":"9,4","2":"76,4","3":"11,158355","4":"-1,75835546"},{"1":"11,9","2":"112,9","3":"13,167600","4":"-1,26760045"},{"1":"6,9","2":"27,5","3":"8,466518","4":"-1,56651766"},{"1":"16,0","2":"171,3","3":"16,382392","4":"-0,38239242"},{"1":"15,5","2":"156,6","3":"15,573190","4":"-0,07318965"},{"1":"9,7","2":"59,6","3":"10,233552","4":"-0,53355229"},{"1":"6,6","2":"19,4","3":"8,020630","4":"-1,42063041"},{"1":"8,0","2":"17,9","3":"7,938059","4":"0,06194130"},{"1":"22,6","2":"216,4","3":"18,865049","4":"3,73495145"},{"1":"11,0","2":"116,0","3":"13,338249","4":"-2,33824865"},{"1":"12,6","2":"66,1","3":"10,591363","4":"2,00863696"},{"1":"17,3","2":"191,1","3":"17,472339","4":"-0,17233902"},{"1":"17,2","2":"135,2","3":"14,395167","4":"2,80483344"},{"1":"10,1","2":"44,7","3":"9,413340","4":"0,68666005"},{"1":"14,0","2":"94,2","3":"12,138206","4":"1,86179356"},{"1":"20,7","2":"238,2","3":"20,065091","4":"0,63490924"},{"1":"18,0","2":"218,4","3":"18,975144","4":"-0,97514417"},{"1":"17,1","2":"215,4","3":"18,810001","4":"-1,71000075"},{"1":"21,8","2":"241,7","3":"20,257758","4":"1,54224191"},{"1":"11,9","2":"80,2","3":"11,367537","4":"0,53246287"},{"1":"16,8","2":"276,7","3":"22,184431","4":"-5,38443137"},{"1":"24,7","2":"220,3","3":"19,079735","4":"5,62026500"},{"1":"16,1","2":"280,7","3":"22,404623","4":"-6,30462260"},{"1":"16,1","2":"175,1","3":"16,591574","4":"-0,49157409"},{"1":"22,6","2":"205,0","3":"18,237504","4":"4,36249646"},{"1":"18,9","2":"248,8","3":"20,648598","4":"-1,74859753"},{"1":"10,3","2":"140,3","3":"14,675910","4":"-4,37591038"},{"1":"22,4","2":"195,4","3":"17,709045","4":"4,69095541"},{"1":"17,1","2":"175,7","3":"16,624603","4":"0,47539722"},{"1":"14,7","2":"74,7","3":"11,064774","4":"3,63522581"},{"1":"10,8","2":"36,9","3":"8,983967","4":"1,81603295"},{"1":"15,3","2":"93,9","3":"12,121692","4":"3,17830790"},{"1":"9,5","2":"25,6","3":"8,361927","4":"1,13807318"},{"1":"11,9","2":"117,2","3":"13,404306","4":"-1,50430602"},{"1":"5,9","2":"17,2","3":"7,899525","4":"-1,99952524"},{"1":"5,6","2":"13,2","3":"7,679334","4":"-2,07933401"},{"1":"15,0","2":"137,9","3":"14,543796","4":"0,45620436"},{"1":"16,9","2":"234,5","3":"19,861414","4":"-2,96141388"},{"1":"27,0","2":"276,9","3":"22,195441","4":"4,80455907"},{"1":"9,6","2":"43,0","3":"9,319759","4":"0,28024132"},{"1":"8,8","2":"26,8","3":"8,427984","4":"0,37201581"},{"1":"11,8","2":"76,4","3":"11,158355","4":"0,64164454"},{"1":"17,2","2":"218,5","3":"18,980649","4":"-1,78064895"},{"1":"3,2","2":"4,1","3":"7,178399","4":"-3,97839896"},{"1":"14,8","2":"177,0","3":"16,696165","4":"-1,89616493"},{"1":"11,5","2":"107,4","3":"12,864838","4":"-1,36483750"},{"1":"20,9","2":"240,1","3":"20,169682","4":"0,73031840"},{"1":"17,0","2":"213,4","3":"18,699905","4":"-1,69990513"},{"1":"16,7","2":"222,4","3":"19,195335","4":"-2,49533540"},{"1":"10,3","2":"139,5","3":"14,631872","4":"-4,33187213"},{"1":"19,7","2":"187,9","3":"17,296186","4":"2,40381397"},{"1":"17,6","2":"253,8","3":"20,923837","4":"-3,32383657"},{"1":"13,6","2":"68,4","3":"10,717973","4":"2,88202700"},{"1":"20,8","2":"273,7","3":"22,019288","4":"-1,21928794"},{"1":"14,0","2":"134,3","3":"14,345624","4":"-0,34562353"},{"1":"20,9","2":"286,0","3":"22,696376","4":"-1,79637598"},{"1":"23,7","2":"198,9","3":"17,901712","4":"5,79828808"},{"1":"20,7","2":"184,9","3":"17,131043","4":"3,56895739"},{"1":"16,0","2":"131,1","3":"14,169471","4":"1,83052945"},{"1":"18,4","2":"225,8","3":"19,382498","4":"-0,98249795"},{"1":"11,8","2":"57,5","3":"10,117952","4":"1,68204811"},{"1":"15,2","2":"123,1","3":"13,729088","4":"1,47091191"},{"1":"20,9","2":"209,6","3":"18,490723","4":"2,40927654"},{"1":"9,7","2":"62,3","3":"10,382181","4":"-0,68218137"},{"1":"11,0","2":"31,5","3":"8,686709","4":"2,31329111"},{"1":"19,8","2":"255,4","3":"21,011913","4":"-1,21191306"},{"1":"25,4","2":"266,9","3":"21,644963","4":"3,75503715"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>Calculando o desvio-padrão dos resíduos:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">modelo_augment</span><span class="op">)</span></span>
<span><span class="va">dp_residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">modelo_augment</span><span class="op">$</span><span class="va">.resid</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dp_residuos</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2,402205</code></pre>
</div>
</div>
<p>Este valor pode ser obtido na coluna <code>sigma</code> do <em>data frame</em> retornado pela função <code>glance</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo_glance</span> <span class="op">&lt;-</span> <span class="fu">glance</span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span>
<span><span class="va">modelo_glance</span><span class="op">$</span><span class="va">sigma</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2,402205</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Desvio-padrão dos resíduos
</div>
</div>
<div class="callout-body-container callout-body">
<p>No geral, então, em uma regressão da variável <span class="math inline">\(y\)</span> sobre a variável <span class="math inline">\(x\)</span> com <span class="math inline">\(n\)</span> observações, o desvio-padrão dos resíduos é</p>
<p><span class="math display">\[
\displaystyle
s_{\text{residuos}} =
\sqrt{
\frac{\sum_i (y_i - \widehat{y}_i)^2}{n-2}
}
\]</span></p>
<p>Pela <a href="#fig-spread" class="quarto-xref">Figura&nbsp;<span>1.1</span></a> e pelos comentários acima, quanto <span class="hl">maior</span> o valor de <span class="math inline">\(s_{\text{residuos}}\)</span>, <span class="hl">maior</span> a nossa incerteza.</p>
</div>
</div>
</section><section id="espalhamento-de-x" class="level4"><h4 class="anchored" data-anchor-id="espalhamento-de-x">Espalhamento de <span class="math inline">\(x\)</span>
</h4>
<p>Quanto maior o espalhamento dos valores de <span class="math inline">\(x\)</span>, maior nossa confiança na reta de regressão, pois ela estará baseada em uma diversidade maior de valores.</p>
<p>Observe a <a href="#fig-spread-x" class="quarto-xref">Figura&nbsp;<span>1.2</span></a>. O gráfico da direita tem um espalhamento maior dos valores de <span class="math inline">\(x\)</span>. Uma reta de regressão, ali, parece estar mais bem “ancorada”.</p>
<div id="fig-spread-x" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Dois gráficos de dispersão" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-spread-x-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/spread-x.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Dois gráficos de dispersão">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spread-x-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1.2: Espalhamento de <span class="math inline">\(x\)</span>
</figcaption></figure>
</div>
<p>O espalhamento de <span class="math inline">\(x\)</span> é medido pelo desvio-padrão, que é calculado da maneira usual.</p>
<p><a href="#lm-vendas-tv">No exemplo das vendas</a>, <span class="math inline">\(s_x\)</span>, o desvio-padrão de <code>tv</code> é</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dp_x</span> <span class="op">&lt;-</span> <span class="va">modelo_augment</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">tv</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dp_x</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86,10888</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Desvio-padrão dos resíduos
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pela <a href="#fig-spread-x" class="quarto-xref">Figura&nbsp;<span>1.2</span></a> e pelos comentários acima, quanto <span class="hl">maior</span> o valor de <span class="math inline">\(s_x\)</span>, <span class="hl">menor</span> a nossa incerteza.</p>
</div>
</div>
</section><section id="quantidade-de-dados" class="level4"><h4 class="anchored" data-anchor-id="quantidade-de-dados">Quantidade de dados</h4>
<p>Uma reta baseada em mais pontos é mais confiável. Observe a <a href="#fig-n" class="quarto-xref">Figura&nbsp;<span>1.3</span></a>.</p>
<div id="fig-n" class="quarto-figure quarto-figure-center quarto-float anchored" alt="Dois gráficos de dispersão" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-n-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="images/quantidade-dados.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%" alt="Dois gráficos de dispersão">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-n-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1.3: Quantidade de dados
</figcaption></figure>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Quantidade de dados
</div>
</div>
<div class="callout-body-container callout-body">
<p>Pela <a href="#fig-n" class="quarto-xref">Figura&nbsp;<span>1.3</span></a> e pelos comentários acima, quanto <span class="hl">maior</span> o valor de <span class="math inline">\(n\)</span>, <span class="hl">menor</span> a nossa incerteza.</p>
</div>
</div>
</section><section id="juntando-tudo" class="level4"><h4 class="anchored" data-anchor-id="juntando-tudo">Juntando tudo</h4>
<p>Vimos que</p>
<ul>
<li>Quanto maior o desvio-padrão dos resíduos (<span class="math inline">\(s_{\text{residuos}}\)</span>), <span class="hl">maior</span> a incerteza.</li>
<li>Quanto maior o desvio-padrão da variável <span class="math inline">\(x\)</span> (<span class="math inline">\(s_x\)</span>), <span class="hl">menor</span> a incerteza.</li>
<li>Quanto maior a quantidade de dados (<span class="math inline">\(n\)</span>), <span class="hl">menor</span> a incerteza.</li>
</ul>
<p>Concluímos que a incerteza sobre nossa estimativa para <span class="math inline">\(\beta_1\)</span> (a inclinação da reta) é proporcional aos valores acima da seguinte maneira:</p>
<p><span class="math display">\[
EP(\beta_1) \propto \frac{s_{\text{residuos}}}{n \cdot s_x}
\]</span></p>
<p>onde estamos escrevendo a incerteza como <span class="hl"><span class="math inline">\(EP(\beta_1)\)</span></span>, o <span class="hl">erro-padrão</span> de <span class="math inline">\(\beta_1\)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Erro-padrão de <span class="math inline">\(\beta_1\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>A fórmula exata para a incerteza sobre <span class="math inline">\(\beta_1\)</span> é</p>
<p><span class="math display">\[
EP(\beta_1) = \frac{s_{\text{residuos}}}{\sqrt{n - 1} \cdot s_x}
\]</span></p>
</div>
</div>
<p><a href="#lm-vendas-tv">No exemplo das vendas</a>, usando as variáveis que já calculamos antes, este erro-padrão é</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">dp_residuos</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="va">dp_x</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0,002285436</code></pre>
</div>
</div>
<p>Este valor aparece nos resultados de <code>lm</code> como <code>std.error</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo_tidy</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["term"],"name":[1],"type":["chr"],"align":["left"]},{"label":["estimate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["std.error"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["statistic"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["p.value"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"(Intercept)","2":"6,95270294","3":"0,386108602","4":"18,00712","5":"4,042245e-39"},{"1":"tv","2":"0,05504781","3":"0,002285436","4":"24,08635","5":"4,566743e-53"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section><section id="erro-padrão-do-intercepto" class="level4"><h4 class="anchored" data-anchor-id="erro-padrão-do-intercepto">Erro-padrão do intercepto</h4>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Erro-padrão de <span class="math inline">\(\beta_0\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Para o intercepto <span class="math inline">\(\beta_0\)</span>, o raciocínio é análogo.</p>
<p>A fórmula exata para a incerteza sobre <span class="math inline">\(\beta_0\)</span> é</p>
<p><span class="math display">\[
EP(\beta_0) =
\]</span></p>
</div>
</div>
<p>??? ISLR p.&nbsp;76</p>
</section></section></section><section id="visão-geométrica" class="level2" data-number="1.3"><h2 data-number="1.3" class="anchored" data-anchor-id="visão-geométrica">
<span class="header-section-number">1.3</span> Visão geométrica</h2>
<p><span class="citation" data-cites="faraway16:_linear_model_r">Faraway (<a href="references.html#ref-faraway16:_linear_model_r" role="doc-biblioref">2016</a>)</span></p>
<section id="um-pequeno-exemplo" class="level3"><h3 class="anchored" data-anchor-id="um-pequeno-exemplo">Um pequeno exemplo</h3>
<p>Para podermos visualizar a geometria, vamos considerar um conjunto de dados com apenas <span class="math inline">\(3\)</span> observações.</p>
<p>A variável <code>x</code> é o único preditor, e a variável <code>y</code> é a resposta.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<div id="oojvyqcypi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#oojvyqcypi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#oojvyqcypi thead, #oojvyqcypi tbody, #oojvyqcypi tfoot, #oojvyqcypi tr, #oojvyqcypi td, #oojvyqcypi th {
  border-style: none;
}

#oojvyqcypi p {
  margin: 0;
  padding: 0;
}

#oojvyqcypi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oojvyqcypi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#oojvyqcypi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oojvyqcypi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oojvyqcypi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oojvyqcypi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oojvyqcypi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oojvyqcypi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oojvyqcypi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oojvyqcypi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oojvyqcypi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oojvyqcypi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oojvyqcypi .gt_spanner_row {
  border-bottom-style: hidden;
}

#oojvyqcypi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#oojvyqcypi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oojvyqcypi .gt_from_md > :first-child {
  margin-top: 0;
}

#oojvyqcypi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oojvyqcypi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oojvyqcypi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#oojvyqcypi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#oojvyqcypi .gt_row_group_first td {
  border-top-width: 2px;
}

#oojvyqcypi .gt_row_group_first th {
  border-top-width: 2px;
}

#oojvyqcypi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oojvyqcypi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#oojvyqcypi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#oojvyqcypi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oojvyqcypi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oojvyqcypi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oojvyqcypi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#oojvyqcypi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oojvyqcypi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oojvyqcypi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oojvyqcypi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oojvyqcypi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oojvyqcypi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#oojvyqcypi .gt_left {
  text-align: left;
}

#oojvyqcypi .gt_center {
  text-align: center;
}

#oojvyqcypi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oojvyqcypi .gt_font_normal {
  font-weight: normal;
}

#oojvyqcypi .gt_font_bold {
  font-weight: bold;
}

#oojvyqcypi .gt_font_italic {
  font-style: italic;
}

#oojvyqcypi .gt_super {
  font-size: 65%;
}

#oojvyqcypi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#oojvyqcypi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#oojvyqcypi .gt_indent_1 {
  text-indent: 5px;
}

#oojvyqcypi .gt_indent_2 {
  text-indent: 10px;
}

#oojvyqcypi .gt_indent_3 {
  text-indent: 15px;
}

#oojvyqcypi .gt_indent_4 {
  text-indent: 20px;
}

#oojvyqcypi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="x" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x</th>
<th id="y" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">y</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="x">1</td>
<td class="gt_row gt_right" headers="y">4</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">2</td>
<td class="gt_row gt_right" headers="y">3</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">3</td>
<td class="gt_row gt_right" headers="y">8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Graficamente:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="simples_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Com um único preditor, este é um exemplo de regressão simples. Queremos achar uma equação da forma</p>
<p><span class="math display">\[
\hat y = \beta_0 + \beta_1x
\]</span></p>
<p>com valores de <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> que garantam a menor soma dos quadrados dos resíduos.</p>
<p>Usamos o R para achar os coeficientes e outras informações sobre este modelo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">modelo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">modelo</span><span class="op">)</span></span></code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x, data = df)

Residuals:
 1  2  3 
 1 -2  1 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    1,000      3,742   0,267    0,834
x              2,000      1,732   1,155    0,454

Residual standard error: 2,449 on 1 degrees of freedom
Multiple R-squared:  0,5714,    Adjusted R-squared:  0,1429 
F-statistic: 1,333 on 1 and 1 DF,  p-value: 0,4544</code></pre>
</div>
</div>
<p>A equação da reta que procuramos é</p>
<p><span class="math display">\[
\hat y = 1{,}00 + 2{,}00 x
\]</span></p>
<p>No gráfico, os valores de <span class="math inline">\(\hat y\)</span>, para cada valor de <span class="math inline">\(x\)</span>, são mostrados em vermelho. A reta de regressão é mostrada em azul:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="simples_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Os valores de <span class="math inline">\(y\)</span>, os valores previstos e os resíduos são</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div>
<div id="tleqcovefr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tleqcovefr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tleqcovefr thead, #tleqcovefr tbody, #tleqcovefr tfoot, #tleqcovefr tr, #tleqcovefr td, #tleqcovefr th {
  border-style: none;
}

#tleqcovefr p {
  margin: 0;
  padding: 0;
}

#tleqcovefr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tleqcovefr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tleqcovefr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tleqcovefr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tleqcovefr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tleqcovefr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tleqcovefr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tleqcovefr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tleqcovefr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tleqcovefr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tleqcovefr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tleqcovefr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tleqcovefr .gt_spanner_row {
  border-bottom-style: hidden;
}

#tleqcovefr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tleqcovefr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tleqcovefr .gt_from_md > :first-child {
  margin-top: 0;
}

#tleqcovefr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tleqcovefr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tleqcovefr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tleqcovefr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tleqcovefr .gt_row_group_first td {
  border-top-width: 2px;
}

#tleqcovefr .gt_row_group_first th {
  border-top-width: 2px;
}

#tleqcovefr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tleqcovefr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tleqcovefr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tleqcovefr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tleqcovefr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tleqcovefr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tleqcovefr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tleqcovefr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tleqcovefr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tleqcovefr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tleqcovefr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tleqcovefr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tleqcovefr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tleqcovefr .gt_left {
  text-align: left;
}

#tleqcovefr .gt_center {
  text-align: center;
}

#tleqcovefr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tleqcovefr .gt_font_normal {
  font-weight: normal;
}

#tleqcovefr .gt_font_bold {
  font-weight: bold;
}

#tleqcovefr .gt_font_italic {
  font-style: italic;
}

#tleqcovefr .gt_super {
  font-size: 65%;
}

#tleqcovefr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tleqcovefr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tleqcovefr .gt_indent_1 {
  text-indent: 5px;
}

#tleqcovefr .gt_indent_2 {
  text-indent: 10px;
}

#tleqcovefr .gt_indent_3 {
  text-indent: 15px;
}

#tleqcovefr .gt_indent_4 {
  text-indent: 20px;
}

#tleqcovefr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="header gt_col_headings">
<th id="x" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">x</th>
<th id="y" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">y</th>
<th id="previsto" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">previsto</th>
<th id="resíduo" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">resíduo</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_right" headers="x">1</td>
<td class="gt_row gt_right" headers="y">4</td>
<td class="gt_row gt_right" headers="previsto">3</td>
<td class="gt_row gt_right" headers="resíduo">1</td>
</tr>
<tr class="even">
<td class="gt_row gt_right" headers="x">2</td>
<td class="gt_row gt_right" headers="y">3</td>
<td class="gt_row gt_right" headers="previsto">5</td>
<td class="gt_row gt_right" headers="resíduo">-2</td>
</tr>
<tr class="odd">
<td class="gt_row gt_right" headers="x">3</td>
<td class="gt_row gt_right" headers="y">8</td>
<td class="gt_row gt_right" headers="previsto">7</td>
<td class="gt_row gt_right" headers="resíduo">1</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p>Usando Álgebra Linear, vamos encarar este modelo de outra forma.</p>
<p>A coluna <code>y</code> dos dados é representada pelo vetor</p>
<p><span class="math display">\[
\mathbf{Y} = \begin{bmatrix}
  4 \\ 3 \\ 8
\end{bmatrix}
\]</span></p>
<p>Vamos definir a seguinte matriz:</p>
<p><span class="math display">\[
\mathbf{X} = \begin{bmatrix}
  1 &amp; 1 \\ 1 &amp; 2 \\ 1 &amp; 3
\end{bmatrix}
\]</span></p>
<p>Nesta matriz, a segunda coluna corresponde à coluna <code>x</code> dos dados. A primeira coluna, com valores <span class="math inline">\(1\)</span>, está ali para podermos escrever o modelo como a equação matricial</p>
<p><span class="math display">\[
\mathbf{\widehat{Y}} = \mathbf{X} \cdot \begin{bmatrix}
  \beta_0 \\ \beta_1
\end{bmatrix}
\]</span></p>
<p>que, de forma mais detalhada, é</p>
<p><span class="math display">\[
\begin{bmatrix}
  \widehat{y_1} \\ \widehat{y_2} \\ \widehat{y_3}
\end{bmatrix}
=
\begin{bmatrix}
  1 &amp; 1 \\ 1 &amp; 2 \\ 1 &amp; 3
\end{bmatrix}
\cdot \begin{bmatrix}
  \beta_0 \\ \beta_1
\end{bmatrix}
\]</span></p>
<p>ou, ainda,</p>
<p><span class="math display">\[
\begin{bmatrix}
  \widehat{y_1} \\ \widehat{y_2} \\ \widehat{y_3}
\end{bmatrix}
=
\begin{bmatrix}
  \beta_0 + \phantom{1\cdot{}}\beta_1 \\
  \beta_0 + 2\cdot \beta_1 \\
  \beta_0 + 3\cdot \beta_1
\end{bmatrix}
\]</span></p>
<p>ou, explicitando os vetores que correspondem às colunas da matriz <span class="math inline">\(\mathbf{X}\)</span>:</p>
<p><span id="eq-modelo"><span class="math display">\[
\begin{bmatrix}
  \widehat{y_1} \\ \widehat{y_2} \\ \widehat{y_3}
\end{bmatrix}
=
\beta_0 \cdot
\begin{bmatrix}
  1 \\ 1 \\ 1
\end{bmatrix}
+
\beta_1 \cdot
\begin{bmatrix}
  1 \\ 2 \\ 3
\end{bmatrix}
\tag{1.1}\]</span></span></p>
<p>Agora, as considerações geométricas:</p>
<ol type="1">
<li><p>As colunas <code>x</code> e <code>y</code> do conjunto de dados são vetores com <span class="math inline">\(3\)</span> componentes, que vivem em <span class="math inline">\(\mathbb{R}^3\)</span>.</p></li>
<li><p>O vetor <span class="math inline">\(\mathbf{\widehat Y}\)</span> também tem <span class="math inline">\(3\)</span> componentes, mas a <a href="#eq-modelo" class="quarto-xref">Equação&nbsp;<span>1.1</span></a> está dizendo que <span class="math inline">\(\mathbf{\widehat Y}\)</span> é uma combinação linear dos dois vetores (linearmente independentes) <span class="math inline">\([1\ 1\ 1]^T\)</span> e <span class="math inline">\([1\ 2\ 3]^T\)</span>.</p></li>
<li><p>Os dois vetores <span class="math inline">\([1\ 1\ 1]^T\)</span> e <span class="math inline">\([1\ 2\ 3]^T\)</span> não são capazes de gerar todo o espaço <span class="math inline">\(\mathbb{R}^3\)</span>; o espaço gerado por eles é um plano.</p></li>
<li><p>O vetor <span class="math inline">\(\mathbf{Y}\)</span> (com os valores verdadeiros da variável de resposta <span class="math inline">\(y\)</span>) não está no plano gerado pelos vetores <span class="math inline">\([1\ 1\ 1]^T\)</span> e <span class="math inline">\([1\ 2\ 3]^T\)</span> (verifique).</p></li>
<li>
<p>A relação verdadeira entre <span class="math inline">\(\mathbf{Y}\)</span> e <span class="math inline">\(\mathbf{X}\)</span> é</p>
<p><span class="math display">\[
\begin{bmatrix}
   y_1 \\ {y_2} \\ {y_3}
\end{bmatrix}
=
\beta_0 \cdot
\begin{bmatrix}
   1 \\ 1 \\ 1
\end{bmatrix}
+
\beta_1 \cdot
\begin{bmatrix}
   1 \\ 2 \\ 3
\end{bmatrix}
+
\begin{bmatrix}
   \varepsilon_1 \\ \varepsilon_2 \\ \varepsilon_3
\end{bmatrix}
\]</span> onde os valores <span class="math inline">\(\varepsilon_i\)</span> são os erros que o modelo não consegue capturar.</p>
</li>
<li>
<p>Estes erros <span class="math inline">\(\varepsilon_i\)</span> são estimados pelos resíduos <span class="math inline">\(\widehat{\varepsilon_i}\)</span>, de maneira que podemos escrever</p>
<p><span class="math display">\[
\begin{bmatrix}
   \widehat{y_1} \\ \widehat{y_2} \\ \widehat{y_3}
\end{bmatrix}
=
\beta_0 \cdot
\begin{bmatrix}
   1 \\ 1 \\ 1
\end{bmatrix}
+
\beta_1 \cdot
\begin{bmatrix}
   1 \\ 2 \\ 3
\end{bmatrix}
+
\begin{bmatrix}
   \widehat{\varepsilon_1} \\
   \widehat{\varepsilon_2} \\
   \widehat{\varepsilon_3}
\end{bmatrix}
\]</span></p>
<p>O vetor de resíduos é</p>
<p><span class="math display">\[
\mathbf{\widehat{\varepsilon}}
=
\begin{bmatrix}
   \widehat{\varepsilon_1} \\
   \widehat{\varepsilon_2} \\
   \widehat{\varepsilon_3}
\end{bmatrix}
=
\begin{bmatrix}
    \phantom{-}1 \\ -2 \\ \phantom{-}1
\end{bmatrix}
\]</span></p>
</li>
</ol>
<p>A situação é mostrada na figura:</p>
<p><img src="images/regressao-visao-geometrica.png" class="img-fluid"></p>
<p>O plano cinza é o espaço gerado pelos vetores <span class="math inline">\([1\ 1\ 1]^T\)</span> e <span class="math inline">\([1\ 2\ 3]^T\)</span>. Na equação paramétrica deste plano, <span class="math inline">\(r\)</span> e <span class="math inline">\(s\)</span> correspondem aos valores possíveis de <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>, respectivamente.</p>
<p>O vetor <span class="math inline">\(\mathbf{\widehat{Y}}\)</span> (dos valores previstos pelo modelo) é a projeção ortogonal do vetor <span class="math inline">\(\mathbf{Y}\)</span> (dos valores verdadeiros da variável de resposta) sobre o plano gerado pelas colunas da matriz <span class="math inline">\(\mathbf{X}\)</span>. Mais abaixo, vamos ver os detalhes desta projeção. O importante é entender que, quaisquer que sejam os valores de <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>, o vetor <span class="math inline">\(\mathbf{\widehat{Y}}\)</span> de valores previstos vai estar sempre limitado ao plano gerado pelas colunas da matriz <span class="math inline">\(\mathbf{X}\)</span>.</p>
<p>Isto corresponde à intuição de que estamos perdendo informação ao tentar representar objetos de dimensão <span class="math inline">\(3\)</span> (o número de observações do conjunto de dados) em um espaço de dimensão <span class="math inline">\(2\)</span> (o número de parâmetros do modelo: <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span>).</p>
<p>???</p>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-de15:_stats" class="csl-entry" role="listitem">
De Veaux, R. D., P. F. Velleman, e D. E. Bock. 2016. <em>Stats: Data and Models</em>. 4.ª ed. Pearson Education. <a href="https://media.pearsoncmg.com/aw/aw_deveaux_stats_4_2016/websites/statdm4d_comp_web_launch.html">https://media.pearsoncmg.com/aw/aw_deveaux_stats_4_2016/websites/statdm4d_comp_web_launch.html</a>.
</div>
<div id="ref-faraway16:_linear_model_r" class="csl-entry" role="listitem">
Faraway, Julian J. 2016. <em>Linear Models with R</em>. 2.ª ed. Chapman; Hall/CRC. <a href="https://doi.org/10.1201/b17144">https://doi.org/10.1201/b17144</a>.
</div>
<div id="ref-james21:_introd_statis_learn" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, e Robert Tibshirani. 2021. <em>An Introduction to Statistical Learning: With Applications in R</em>. 2.ª ed. Springer Publishing Company, Incorporated. <a href="https://www.statlearning.com/">https://www.statlearning.com/</a>.
</div>
</div>
</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiada");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiada");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("^(?:http:|https:)\/\/fnaufel\.github\.io\/regressao-linear");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
          // default icon
          link.classList.add("external");
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Apresentação">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Apresentação</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./multipla.html" class="pagination-link" aria-label="Regressão linear múltipla">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Regressão linear múltipla</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Código fonte</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb25" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>{{&lt; include _math.qmd &gt;}}</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r echo=FALSE, message=FALSE}</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="in">source('_setup.R')</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu"># Regressão linear simples</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exemplo: vendas e publicidade</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>Exemplo baseado no livro @james21:_introd_statis_learn, com dados obtidos de <span class="ot">&lt;https://www.kaggle.com/datasets/ashydv/advertising-dataset/data&gt;</span>.</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>Este conjunto de dados contém $4$ colunas:</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`tv`</span>: verba (em milhares de dólares) gasta em publicidade na TV;</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`radio`</span>: verba (em milhares de dólares) gasta em publicidade no rádio;</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`jornal`</span>: verba (em milhares de dólares) gasta em publicidade em jornais;</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span><span class="in">`vendas`</span>: receita das vendas (em milhares de dólares).</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>Cada observação --- isto é, cada linha --- corresponde a um produto.</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="fu">### Leitura e limpeza</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>publicidade <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">'dados/advertising.csv'</span>,</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">show_col_types =</span> <span class="cn">FALSE</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>  janitor<span class="sc">::</span><span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">jornal =</span> newspaper,</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">vendas =</span> sales</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>publicidade <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="fu">### Divisão em dados de treino e teste</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(publicidade)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>treino <span class="ot">&lt;-</span> <span class="fu">training</span>(split)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>teste <span class="ot">&lt;-</span> <span class="fu">testing</span>(split)</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>split</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="fu">### Vendas por verba gasta em TV</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Análise exploratória</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>Começamos visualizando os dados:</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>grafico <span class="ot">&lt;-</span> treino <span class="sc">%&gt;%</span> </span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(tv, vendas)) <span class="sc">+</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>()</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>grafico</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>A correlação linear entre vendas e tv é</span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(treino<span class="sc">$</span>vendas, treino<span class="sc">$</span>tv)</span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Modelo linear {#lm-vendas-tv}</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(vendas <span class="sc">~</span> tv, <span class="at">data =</span> treino)</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>modelo_tidy <span class="ot">&lt;-</span> <span class="fu">tidy</span>(modelo)</span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>modelo_tidy</span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> modelo_tidy<span class="sc">$</span>estimate[<span class="dv">1</span>]</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> modelo_tidy<span class="sc">$</span>estimate[<span class="dv">2</span>]</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>grafico <span class="sc">+</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">intercept =</span> b0,</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">slope =</span> b1,</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">'blue'</span></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a>A equação da reta é</span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>  \widehat{\text{vendas}} </span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a>  &amp;= \hat{\beta_0} + \hat{\beta_1} \cdot \text{tv} <span class="sc">\\</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a>  &amp;= <span class="in">`r b0`</span> + <span class="in">`r b1`</span> \cdot \text{tv}</span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a><span class="fu">## Teoria</span></span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimativas $\hat{\beta_0}$ e $\hat{\beta_1}$</span></span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a>Os valores achados são estimativas para $\beta_0$ e $\beta_1$, baseadas nos dados do conjunto de treino.</span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a>Por isso, os valores de <span class="in">`vendas`</span> obtidos com esta equação também são estimativas.</span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a>Vamos escrever estimativas com o acento circunflexo (chapéu) sobre os símbolos.</span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a>De onde vêm os valores de $\hat{\beta_0}$ e $\hat{\beta_1}$?</span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a>Resposta: são os valores que fazem com que a soma dos quadrados das distâncias verticais dos pontos à reta seja a menor possível. </span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a>(Estas distâncias são chamadas de <span class="co">[</span><span class="ot">resíduos</span><span class="co">]</span>{.hl}.)</span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Consulte este material</span><span class="co">](https://fnaufel.github.io/probestr/regr.html#como-achar-a-equa%C3%A7%C3%A3o-da-melhor-reta-com-c%C3%A1lculo)</span> para ver os detalhes sobre o cálculo de $\hat{\beta_0}$ e $\hat{\beta_1}$.</span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a><span class="fu">### Erros-padrão das estimativas</span></span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a>Vamos pensar nas incertezas associadas aos valores de $\hat{\beta_0}$ e $\hat{\beta_1}$, com base na excelente discussão em <span class="co">[</span><span class="ot">@de15:_stats, cap. 25</span><span class="co">]</span>.</span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a>Quais são os fatores que afetam a nossa confiança na reta de regressão?</span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a>Mais especificamente, <span class="co">[</span><span class="ot">quais os fatores que afetam nossa confiança no valor estimado $\hat\beta_1$</span><span class="co">]</span>{.hl} (a inclinação da reta)?</span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Espalhamento dos pontos em volta da reta</span></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a>Quanto mais afastados da reta estiverem os dados, menor a nossa confiança de que a reta captura a variação de uma variável em função da outra.</span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a>Observe a @fig-spread. O gráfico da esquerda nos dá mais certeza de que uma reta de regressão terá uma inclinação bem próxima da taxa de variação de $y$ em função de $x$ na população.</span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a><span class="al">![Espalhamento dos pontos](images/spread.png)</span>{fig-alt="Dois gráficos de dispersão" #fig-spread width=100% fig-align="center"}</span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a>Este espalhamento é medido pelo <span class="co">[</span><span class="ot">desvio-padrão dos resíduos</span><span class="co">]</span>{.hl}.</span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">No exemplo das vendas</span><span class="co">](#lm-vendas-tv)</span>, este desvio-padrão dos resíduos é calculado como</span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a>\displaystyle</span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a>\sqrt{</span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a>\frac{\sum_i (\text{vendas}_i - \widehat{\text{vendas}}_i)^2}{n-2}</span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a>No numerador, o valor $\text{vendas}_i - \widehat{\text{vendas}}_i$ é o resíduo da observação $i$.</span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a>As <span class="in">`vendas`</span> estimadas para cada valor de <span class="in">`tv`</span> e os valores dos resíduos podem ser acessados assim:</span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a>modelo_augment <span class="ot">&lt;-</span> <span class="fu">augment</span>(modelo)</span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a>modelo_augment <span class="sc">%&gt;%</span> </span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(vendas, tv, .fitted, .resid)</span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a>Calculando o desvio-padrão dos resíduos:</span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(modelo_augment)</span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a>dp_residuos <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(modelo_augment<span class="sc">$</span>.resid<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a>dp_residuos</span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a>Este valor pode ser obtido na coluna <span class="in">`sigma`</span> do *data frame* retornado pela função <span class="in">`glance`</span>:</span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a>modelo_glance <span class="ot">&lt;-</span> <span class="fu">glance</span>(modelo)</span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a>modelo_glance<span class="sc">$</span>sigma</span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a><span class="fu">## Desvio-padrão dos resíduos</span></span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a>No geral, então, em uma regressão da variável $y$ sobre a variável $x$ com $n$ observações, o desvio-padrão dos resíduos é</span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a>\displaystyle</span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a>s_{\text{residuos}} = </span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a>\sqrt{</span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a>\frac{\sum_i (y_i - \widehat{y}_i)^2}{n-2}</span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a>Pela @fig-spread e pelos comentários acima, quanto <span class="co">[</span><span class="ot">maior</span><span class="co">]</span>{.hl} o valor de $s_{\text{residuos}}$, <span class="co">[</span><span class="ot">maior</span><span class="co">]</span>{.hl} a nossa incerteza.</span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-222"><a href="#cb25-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-223"><a href="#cb25-223" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Espalhamento de $x$</span></span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a>Quanto maior o espalhamento dos valores de $x$, maior nossa confiança na reta de regressão, pois ela estará baseada em uma diversidade maior de valores.</span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a>Observe a @fig-spread-x. O gráfico da direita tem um espalhamento maior dos valores de $x$. Uma reta de regressão, ali, parece estar mais bem "ancorada".</span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a><span class="al">![Espalhamento de $x$](images/spread-x.png)</span>{fig-alt="Dois gráficos de dispersão" #fig-spread-x width=100% fig-align="center"}</span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a>O espalhamento de $x$ é medido pelo desvio-padrão, que é calculado da maneira usual. </span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">No exemplo das vendas</span><span class="co">](#lm-vendas-tv)</span>, $s_x$, o desvio-padrão de <span class="in">`tv`</span> é</span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a>dp_x <span class="ot">&lt;-</span> modelo_augment <span class="sc">%&gt;%</span> </span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(tv) <span class="sc">%&gt;%</span> </span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sd</span>()</span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a>dp_x</span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a><span class="fu">## Desvio-padrão dos resíduos</span></span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a>Pela @fig-spread-x e pelos comentários acima, quanto <span class="co">[</span><span class="ot">maior</span><span class="co">]</span>{.hl} o valor de $s_x$, <span class="co">[</span><span class="ot">menor</span><span class="co">]</span>{.hl} a nossa incerteza.</span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Quantidade de dados</span></span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a>Uma reta baseada em mais pontos é mais confiável. Observe a @fig-n. </span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-258"><a href="#cb25-258" aria-hidden="true" tabindex="-1"></a><span class="al">![Quantidade de dados](images/quantidade-dados.png)</span>{fig-alt="Dois gráficos de dispersão" #fig-n width=100% fig-align="center"}</span>
<span id="cb25-259"><a href="#cb25-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a><span class="fu">## Quantidade de dados</span></span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a>Pela @fig-n e pelos comentários acima, quanto <span class="co">[</span><span class="ot">maior</span><span class="co">]</span>{.hl} o valor de $n$, <span class="co">[</span><span class="ot">menor</span><span class="co">]</span>{.hl} a nossa incerteza.</span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-269"><a href="#cb25-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-270"><a href="#cb25-270" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Juntando tudo</span></span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a>Vimos que</span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Quanto maior o desvio-padrão dos resíduos ($s_{\text{residuos}}$), <span class="co">[</span><span class="ot">maior</span><span class="co">]</span>{.hl} a incerteza.</span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Quanto maior o desvio-padrão da variável $x$ ($s_x$), <span class="co">[</span><span class="ot">menor</span><span class="co">]</span>{.hl} a incerteza.</span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Quanto maior a quantidade de dados ($n$), <span class="co">[</span><span class="ot">menor</span><span class="co">]</span>{.hl} a incerteza.</span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a>Concluímos que a incerteza sobre nossa estimativa para $\beta_1$ (a inclinação da reta) é proporcional aos valores acima da seguinte maneira:</span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a>EP(\beta_1) \propto \frac{s_{\text{residuos}}}{n \cdot s_x}</span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a>onde estamos escrevendo a incerteza como <span class="co">[</span><span class="ot">$EP(\beta_1)$</span><span class="co">]</span>{.hl}, o <span class="co">[</span><span class="ot">erro-padrão</span><span class="co">]</span>{.hl} de $\beta_1$.</span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-288"><a href="#cb25-288" aria-hidden="true" tabindex="-1"></a><span class="fu">## Erro-padrão de $\beta_1$</span></span>
<span id="cb25-289"><a href="#cb25-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a>A fórmula exata para a incerteza sobre $\beta_1$ é</span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a>EP(\beta_1) = \frac{s_{\text{residuos}}}{\sqrt{n - 1} \cdot s_x}</span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">No exemplo das vendas</span><span class="co">](#lm-vendas-tv)</span>, usando as variáveis que já calculamos antes, este erro-padrão é</span>
<span id="cb25-299"><a href="#cb25-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a>dp_residuos <span class="sc">/</span> (<span class="fu">sqrt</span>(n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> dp_x)</span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a>Este valor aparece nos resultados de <span class="in">`lm`</span> como <span class="in">`std.error`</span>:</span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a>modelo_tidy</span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Erro-padrão do intercepto</span></span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-316"><a href="#cb25-316" aria-hidden="true" tabindex="-1"></a>::: {.callout-important}</span>
<span id="cb25-317"><a href="#cb25-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a><span class="fu">## Erro-padrão de $\beta_0$</span></span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a>Para o intercepto $\beta_0$, o raciocínio é análogo.</span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a>A fórmula exata para a incerteza sobre $\beta_0$ é</span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a>EP(\beta_0) = </span>
<span id="cb25-326"><a href="#cb25-326" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-327"><a href="#cb25-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a>??? ISLR p. 76</span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visão geométrica</span></span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a>@faraway16:_linear_model_r</span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a><span class="fu">### Um pequeno exemplo</span></span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a>Para podermos visualizar a geometria, vamos considerar um conjunto de dados com apenas $3$ observações.</span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a>A variável <span class="in">`x`</span> é o único preditor, e a variável <span class="in">`y`</span> é a resposta.</span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,</span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">8</span>)</span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">gt</span>()</span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a>Graficamente:</span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> </span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(x, y)) <span class="sc">+</span> </span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>()</span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a>p</span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a>Com um único preditor, este é um exemplo de regressão simples. Queremos achar uma equação da forma</span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a>\hat y = \beta_0 + \beta_1x</span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a>com valores de $\beta_0$ e $\beta_1$ que garantam a menor soma dos quadrados dos resíduos.</span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a>Usamos o R para achar os coeficientes e outras informações sobre este modelo:</span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, df)</span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">1</span>]</span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">2</span>]</span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a>A equação da reta que procuramos é</span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a>\hat y = <span class="in">`r b0`</span> + <span class="in">`r b1`</span> x</span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a>No gráfico, os valores de $\hat y$, para cada valor de $x$, são mostrados em vermelho. A reta de regressão é mostrada em azul:</span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> b0, <span class="at">slope =</span> b1, <span class="at">color =</span> <span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fitted.values</span>(modelo)), <span class="at">color =</span> <span class="st">'red'</span>)</span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a>Os valores de $y$, os valores previstos e os resíduos são</span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-421"><a href="#cb25-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-422"><a href="#cb25-422" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb25-423"><a href="#cb25-423" aria-hidden="true" tabindex="-1"></a>modelo_aumentado <span class="ot">&lt;-</span> modelo <span class="sc">%&gt;%</span> </span>
<span id="cb25-424"><a href="#cb25-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">augment</span>()</span>
<span id="cb25-425"><a href="#cb25-425" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-426"><a href="#cb25-426" aria-hidden="true" tabindex="-1"></a>modelo_aumentado <span class="sc">%&gt;%</span> </span>
<span id="cb25-427"><a href="#cb25-427" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(x, y, <span class="at">previsto =</span> .fitted, resíduo <span class="ot">=</span> .resid) <span class="sc">%&gt;%</span> </span>
<span id="cb25-428"><a href="#cb25-428" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span>
<span id="cb25-429"><a href="#cb25-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-430"><a href="#cb25-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-431"><a href="#cb25-431" aria-hidden="true" tabindex="-1"></a>Usando Álgebra Linear, vamos encarar este modelo de outra forma.</span>
<span id="cb25-432"><a href="#cb25-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-433"><a href="#cb25-433" aria-hidden="true" tabindex="-1"></a>A coluna <span class="in">`y`</span> dos dados é representada pelo vetor</span>
<span id="cb25-434"><a href="#cb25-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-436"><a href="#cb25-436" aria-hidden="true" tabindex="-1"></a>\vec{Y} = \begin{bmatrix}</span>
<span id="cb25-437"><a href="#cb25-437" aria-hidden="true" tabindex="-1"></a>  4 <span class="sc">\\</span> 3 <span class="sc">\\</span> 8</span>
<span id="cb25-438"><a href="#cb25-438" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-439"><a href="#cb25-439" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-440"><a href="#cb25-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-441"><a href="#cb25-441" aria-hidden="true" tabindex="-1"></a>Vamos definir a seguinte matriz:</span>
<span id="cb25-442"><a href="#cb25-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-443"><a href="#cb25-443" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-444"><a href="#cb25-444" aria-hidden="true" tabindex="-1"></a>\vec{X} = \begin{bmatrix}</span>
<span id="cb25-445"><a href="#cb25-445" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 <span class="sc">\\</span> 1 &amp; 2 <span class="sc">\\</span> 1 &amp; 3</span>
<span id="cb25-446"><a href="#cb25-446" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-447"><a href="#cb25-447" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-448"><a href="#cb25-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-449"><a href="#cb25-449" aria-hidden="true" tabindex="-1"></a>Nesta matriz, a segunda coluna corresponde à coluna <span class="in">`x`</span> dos dados. A primeira coluna, com valores $1$, está ali para podermos escrever o modelo como a equação matricial</span>
<span id="cb25-450"><a href="#cb25-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-451"><a href="#cb25-451" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-452"><a href="#cb25-452" aria-hidden="true" tabindex="-1"></a>\vec{\widehat{Y}} = \vec{X} \cdot \begin{bmatrix}</span>
<span id="cb25-453"><a href="#cb25-453" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span> \beta_1</span>
<span id="cb25-454"><a href="#cb25-454" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-455"><a href="#cb25-455" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-456"><a href="#cb25-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-457"><a href="#cb25-457" aria-hidden="true" tabindex="-1"></a>que, de forma mais detalhada, é</span>
<span id="cb25-458"><a href="#cb25-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-459"><a href="#cb25-459" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-460"><a href="#cb25-460" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-461"><a href="#cb25-461" aria-hidden="true" tabindex="-1"></a>  \widehat{y_1} <span class="sc">\\</span> \widehat{y_2} <span class="sc">\\</span> \widehat{y_3}</span>
<span id="cb25-462"><a href="#cb25-462" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-463"><a href="#cb25-463" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb25-464"><a href="#cb25-464" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-465"><a href="#cb25-465" aria-hidden="true" tabindex="-1"></a>  1 &amp; 1 <span class="sc">\\</span> 1 &amp; 2 <span class="sc">\\</span> 1 &amp; 3</span>
<span id="cb25-466"><a href="#cb25-466" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-467"><a href="#cb25-467" aria-hidden="true" tabindex="-1"></a>\cdot \begin{bmatrix}</span>
<span id="cb25-468"><a href="#cb25-468" aria-hidden="true" tabindex="-1"></a>  \beta_0 <span class="sc">\\</span> \beta_1</span>
<span id="cb25-469"><a href="#cb25-469" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-470"><a href="#cb25-470" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-471"><a href="#cb25-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-472"><a href="#cb25-472" aria-hidden="true" tabindex="-1"></a>ou, ainda,</span>
<span id="cb25-473"><a href="#cb25-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-474"><a href="#cb25-474" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-475"><a href="#cb25-475" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-476"><a href="#cb25-476" aria-hidden="true" tabindex="-1"></a>  \widehat{y_1} <span class="sc">\\</span> \widehat{y_2} <span class="sc">\\</span> \widehat{y_3}</span>
<span id="cb25-477"><a href="#cb25-477" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-478"><a href="#cb25-478" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb25-479"><a href="#cb25-479" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-480"><a href="#cb25-480" aria-hidden="true" tabindex="-1"></a>  \beta_0 + \phantom{1\cdot{}}\beta_1 <span class="sc">\\</span></span>
<span id="cb25-481"><a href="#cb25-481" aria-hidden="true" tabindex="-1"></a>  \beta_0 + 2\cdot \beta_1 <span class="sc">\\</span></span>
<span id="cb25-482"><a href="#cb25-482" aria-hidden="true" tabindex="-1"></a>  \beta_0 + 3\cdot \beta_1</span>
<span id="cb25-483"><a href="#cb25-483" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-484"><a href="#cb25-484" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-485"><a href="#cb25-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-486"><a href="#cb25-486" aria-hidden="true" tabindex="-1"></a>ou, explicitando os vetores que correspondem às colunas da matriz $\vec{X}$:</span>
<span id="cb25-487"><a href="#cb25-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-488"><a href="#cb25-488" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-489"><a href="#cb25-489" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-490"><a href="#cb25-490" aria-hidden="true" tabindex="-1"></a>  \widehat{y_1} <span class="sc">\\</span> \widehat{y_2} <span class="sc">\\</span> \widehat{y_3}</span>
<span id="cb25-491"><a href="#cb25-491" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-492"><a href="#cb25-492" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb25-493"><a href="#cb25-493" aria-hidden="true" tabindex="-1"></a>\beta_0 \cdot </span>
<span id="cb25-494"><a href="#cb25-494" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-495"><a href="#cb25-495" aria-hidden="true" tabindex="-1"></a>  1 <span class="sc">\\</span> 1 <span class="sc">\\</span> 1</span>
<span id="cb25-496"><a href="#cb25-496" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-497"><a href="#cb25-497" aria-hidden="true" tabindex="-1"></a><span class="ss">+ </span></span>
<span id="cb25-498"><a href="#cb25-498" aria-hidden="true" tabindex="-1"></a>\beta_1 \cdot</span>
<span id="cb25-499"><a href="#cb25-499" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb25-500"><a href="#cb25-500" aria-hidden="true" tabindex="-1"></a>  1 <span class="sc">\\</span> 2 <span class="sc">\\</span> 3</span>
<span id="cb25-501"><a href="#cb25-501" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-502"><a href="#cb25-502" aria-hidden="true" tabindex="-1"></a>$$ {#eq-modelo}</span>
<span id="cb25-503"><a href="#cb25-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-504"><a href="#cb25-504" aria-hidden="true" tabindex="-1"></a>Agora, as considerações geométricas:</span>
<span id="cb25-505"><a href="#cb25-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-506"><a href="#cb25-506" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>As colunas <span class="in">`x`</span> e <span class="in">`y`</span> do conjunto de dados são vetores com $3$ componentes, que vivem em $\reais^3$.</span>
<span id="cb25-507"><a href="#cb25-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-508"><a href="#cb25-508" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>O vetor $\vec{\widehat Y}$ também tem $3$ componentes, mas a @eq-modelo está dizendo que $\vec{\widehat Y}$ é uma combinação linear dos dois vetores (linearmente independentes) $<span class="co">[</span><span class="ot">1\ 1\ 1</span><span class="co">]</span>^T$ e $<span class="co">[</span><span class="ot">1\ 2\ 3</span><span class="co">]</span>^T$.</span>
<span id="cb25-509"><a href="#cb25-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-510"><a href="#cb25-510" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Os dois vetores $<span class="co">[</span><span class="ot">1\ 1\ 1</span><span class="co">]</span>^T$ e $<span class="co">[</span><span class="ot">1\ 2\ 3</span><span class="co">]</span>^T$ não são capazes de gerar todo o espaço $\reais^3$; o espaço gerado por eles é um plano.</span>
<span id="cb25-511"><a href="#cb25-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-512"><a href="#cb25-512" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>O vetor $\vec Y$ (com os valores verdadeiros da variável de resposta $y$) não está no plano gerado pelos vetores $<span class="co">[</span><span class="ot">1\ 1\ 1</span><span class="co">]</span>^T$ e $<span class="co">[</span><span class="ot">1\ 2\ 3</span><span class="co">]</span>^T$ (verifique).</span>
<span id="cb25-513"><a href="#cb25-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-514"><a href="#cb25-514" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>A relação verdadeira entre $\vec Y$ e $\vec X$ é</span>
<span id="cb25-515"><a href="#cb25-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-516"><a href="#cb25-516" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb25-517"><a href="#cb25-517" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-518"><a href="#cb25-518" aria-hidden="true" tabindex="-1"></a>      y_1 <span class="sc">\\</span> {y_2} <span class="sc">\\</span> {y_3}</span>
<span id="cb25-519"><a href="#cb25-519" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-520"><a href="#cb25-520" aria-hidden="true" tabindex="-1"></a>    =</span>
<span id="cb25-521"><a href="#cb25-521" aria-hidden="true" tabindex="-1"></a>    \beta_0 \cdot </span>
<span id="cb25-522"><a href="#cb25-522" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-523"><a href="#cb25-523" aria-hidden="true" tabindex="-1"></a>      1 <span class="sc">\\</span> 1 <span class="sc">\\</span> 1</span>
<span id="cb25-524"><a href="#cb25-524" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-525"><a href="#cb25-525" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span></span>
<span id="cb25-526"><a href="#cb25-526" aria-hidden="true" tabindex="-1"></a>    \beta_1 \cdot</span>
<span id="cb25-527"><a href="#cb25-527" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-528"><a href="#cb25-528" aria-hidden="true" tabindex="-1"></a>      1 <span class="sc">\\</span> 2 <span class="sc">\\</span> 3</span>
<span id="cb25-529"><a href="#cb25-529" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-530"><a href="#cb25-530" aria-hidden="true" tabindex="-1"></a>    +</span>
<span id="cb25-531"><a href="#cb25-531" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-532"><a href="#cb25-532" aria-hidden="true" tabindex="-1"></a>      \varepsilon_1 <span class="sc">\\</span> \varepsilon_2 <span class="sc">\\</span> \varepsilon_3</span>
<span id="cb25-533"><a href="#cb25-533" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-534"><a href="#cb25-534" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb25-535"><a href="#cb25-535" aria-hidden="true" tabindex="-1"></a>   onde os valores $\varepsilon_i$ são os erros que o modelo não consegue capturar.</span>
<span id="cb25-536"><a href="#cb25-536" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb25-537"><a href="#cb25-537" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Estes erros $\varepsilon_i$ são estimados pelos resíduos $\widehat{\varepsilon_i}$, de maneira que podemos escrever</span>
<span id="cb25-538"><a href="#cb25-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-539"><a href="#cb25-539" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb25-540"><a href="#cb25-540" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-541"><a href="#cb25-541" aria-hidden="true" tabindex="-1"></a>      \widehat{y_1} <span class="sc">\\</span> \widehat{y_2} <span class="sc">\\</span> \widehat{y_3}</span>
<span id="cb25-542"><a href="#cb25-542" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-543"><a href="#cb25-543" aria-hidden="true" tabindex="-1"></a>    =</span>
<span id="cb25-544"><a href="#cb25-544" aria-hidden="true" tabindex="-1"></a>    \beta_0 \cdot </span>
<span id="cb25-545"><a href="#cb25-545" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-546"><a href="#cb25-546" aria-hidden="true" tabindex="-1"></a>      1 <span class="sc">\\</span> 1 <span class="sc">\\</span> 1</span>
<span id="cb25-547"><a href="#cb25-547" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-548"><a href="#cb25-548" aria-hidden="true" tabindex="-1"></a><span class="ss">    + </span></span>
<span id="cb25-549"><a href="#cb25-549" aria-hidden="true" tabindex="-1"></a>    \beta_1 \cdot</span>
<span id="cb25-550"><a href="#cb25-550" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-551"><a href="#cb25-551" aria-hidden="true" tabindex="-1"></a>      1 <span class="sc">\\</span> 2 <span class="sc">\\</span> 3</span>
<span id="cb25-552"><a href="#cb25-552" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-553"><a href="#cb25-553" aria-hidden="true" tabindex="-1"></a>    +</span>
<span id="cb25-554"><a href="#cb25-554" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-555"><a href="#cb25-555" aria-hidden="true" tabindex="-1"></a>      \widehat{\varepsilon_1} <span class="sc">\\</span> </span>
<span id="cb25-556"><a href="#cb25-556" aria-hidden="true" tabindex="-1"></a>      \widehat{\varepsilon_2} <span class="sc">\\</span> </span>
<span id="cb25-557"><a href="#cb25-557" aria-hidden="true" tabindex="-1"></a>      \widehat{\varepsilon_3}</span>
<span id="cb25-558"><a href="#cb25-558" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-559"><a href="#cb25-559" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb25-560"><a href="#cb25-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-561"><a href="#cb25-561" aria-hidden="true" tabindex="-1"></a>   O vetor de resíduos é</span>
<span id="cb25-562"><a href="#cb25-562" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb25-563"><a href="#cb25-563" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb25-564"><a href="#cb25-564" aria-hidden="true" tabindex="-1"></a>   \vec{\widehat{\varepsilon}} </span>
<span id="cb25-565"><a href="#cb25-565" aria-hidden="true" tabindex="-1"></a>   = </span>
<span id="cb25-566"><a href="#cb25-566" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-567"><a href="#cb25-567" aria-hidden="true" tabindex="-1"></a>      \widehat{\varepsilon_1} <span class="sc">\\</span> </span>
<span id="cb25-568"><a href="#cb25-568" aria-hidden="true" tabindex="-1"></a>      \widehat{\varepsilon_2} <span class="sc">\\</span> </span>
<span id="cb25-569"><a href="#cb25-569" aria-hidden="true" tabindex="-1"></a>      \widehat{\varepsilon_3}</span>
<span id="cb25-570"><a href="#cb25-570" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-571"><a href="#cb25-571" aria-hidden="true" tabindex="-1"></a>    = </span>
<span id="cb25-572"><a href="#cb25-572" aria-hidden="true" tabindex="-1"></a>    \begin{bmatrix}</span>
<span id="cb25-573"><a href="#cb25-573" aria-hidden="true" tabindex="-1"></a>       \phantom{-}1 <span class="sc">\\</span> -2 <span class="sc">\\</span> \phantom{-}1</span>
<span id="cb25-574"><a href="#cb25-574" aria-hidden="true" tabindex="-1"></a>    \end{bmatrix}</span>
<span id="cb25-575"><a href="#cb25-575" aria-hidden="true" tabindex="-1"></a>   $$</span>
<span id="cb25-576"><a href="#cb25-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-577"><a href="#cb25-577" aria-hidden="true" tabindex="-1"></a>A situação é mostrada na figura:</span>
<span id="cb25-578"><a href="#cb25-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-579"><a href="#cb25-579" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/regressao-visao-geometrica.png)</span></span>
<span id="cb25-580"><a href="#cb25-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-581"><a href="#cb25-581" aria-hidden="true" tabindex="-1"></a>O plano cinza é o espaço gerado pelos vetores $<span class="co">[</span><span class="ot">1\ 1\ 1</span><span class="co">]</span>^T$ e $<span class="co">[</span><span class="ot">1\ 2\ 3</span><span class="co">]</span>^T$. Na equação paramétrica deste plano, $r$ e $s$ correspondem aos valores possíveis de $\beta_0$ e $\beta_1$, respectivamente.</span>
<span id="cb25-582"><a href="#cb25-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-583"><a href="#cb25-583" aria-hidden="true" tabindex="-1"></a>O vetor $\vec{\widehat{Y}}$ (dos valores previstos pelo modelo) é a projeção ortogonal do vetor $\vec{Y}$ (dos valores verdadeiros da variável de resposta) sobre o plano gerado pelas colunas da matriz $\vec X$. Mais abaixo, vamos ver os detalhes desta projeção. O importante é entender que, quaisquer que sejam os valores de $\beta_0$ e $\beta_1$, o vetor $\vec{\widehat{Y}}$ de valores previstos vai estar sempre limitado ao plano gerado pelas colunas da matriz $\vec{X}$. </span>
<span id="cb25-584"><a href="#cb25-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-585"><a href="#cb25-585" aria-hidden="true" tabindex="-1"></a>Isto corresponde à intuição de que estamos perdendo informação ao tentar representar objetos de dimensão $3$ (o número de observações do conjunto de dados) em um espaço de dimensão $2$ (o número de parâmetros do modelo: $\beta_0$ e $\beta_1$). </span>
<span id="cb25-586"><a href="#cb25-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-587"><a href="#cb25-587" aria-hidden="true" tabindex="-1"></a>???</span>
</code><button title="Copiar para a área de transferência" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/fnaufel/regressao-linear/edit/master/simples.qmd" class="toc-action"><i class="bi bi-github"></i>Editar essa página</a></li></ul></div></div></div></footer></body></html>